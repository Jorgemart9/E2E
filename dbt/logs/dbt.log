[0m16:23:45.809942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621bd51f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621bd768560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621bdbc1580>]}


============================== 16:23:45.821456 | 61ed1345-121e-4044-8e64-544f03024985 ==============================
[0m16:23:45.821456 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:23:45.822583 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': 'logs', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True'}
[0m16:23:45.827677 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:23:45.830165 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.07380566, "process_in_blocks": "0", "process_kernel_time": 0.565776, "process_mem_max_rss": "103124", "process_out_blocks": "3224", "process_user_time": 1.578219}
[0m16:23:45.832039 [debug] [MainThread]: Command `dbt deps` failed at 16:23:45.831820 after 0.08 seconds
[0m16:23:45.833624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621bdedad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621bd5716a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7621bd9040b0>]}
[0m16:23:45.834283 [debug] [MainThread]: Flushing usage events
[0m16:23:47.004642 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:14.956995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b2c4beb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b2c9b9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b2c9b9c10>]}


============================== 16:24:14.960276 | 01447363-af86-453a-af9b-c5aee8405314 ==============================
[0m16:24:14.960276 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:24:14.961357 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': 'logs', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m16:24:14.962377 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:24:14.963957 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.059187513, "process_in_blocks": "0", "process_kernel_time": 0.30363, "process_mem_max_rss": "100700", "process_out_blocks": "0", "process_user_time": 1.422725}
[0m16:24:14.964533 [debug] [MainThread]: Command `dbt deps` failed at 16:24:14.964447 after 0.06 seconds
[0m16:24:14.964970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b2bb6bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b2c92b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718b2be70680>]}
[0m16:24:14.965394 [debug] [MainThread]: Flushing usage events
[0m16:24:16.524990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:57.841788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772dde88d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ddeaaf7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772dde8e76e0>]}


============================== 16:27:57.846830 | 292b356d-cd27-4db7-a10e-f2d8af16cbc5 ==============================
[0m16:27:57.846830 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:27:57.847998 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': 'logs', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True'}
[0m16:27:57.849670 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:27:57.851669 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.058698025, "process_in_blocks": "0", "process_kernel_time": 0.753809, "process_mem_max_rss": "99876", "process_out_blocks": "0", "process_user_time": 1.242984}
[0m16:27:57.852758 [debug] [MainThread]: Command `dbt deps` failed at 16:27:57.852657 after 0.06 seconds
[0m16:27:57.853464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ddf6fdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ddde56b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ddda6e720>]}
[0m16:27:57.854093 [debug] [MainThread]: Flushing usage events
[0m16:27:57.877793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:32.193335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd7b59e0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd7b572d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd7b572e210>]}


Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:22:32.207167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.09455377, "process_in_blocks": "0", "process_kernel_time": 0.214876, "process_mem_max_rss": "101748", "process_out_blocks": "3240", "process_user_time": 2.474583}
[0m17:22:32.207846 [debug] [MainThread]: Command `dbt deps` failed at 17:22:32.207676 after 0.10 seconds
[0m17:22:32.208313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd7b97c2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd7b500ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd7b500c950>]}
[0m17:22:32.208797 [debug] [MainThread]: Flushing usage events
[0m17:22:32.218071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:19.816314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7881ef387ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7881ef622cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7881ef9256d0>]}


Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:23:19.824889 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.09194979, "process_in_blocks": "0", "process_kernel_time": 0.180913, "process_mem_max_rss": "99124", "process_out_blocks": "8", "process_user_time": 2.020033}
[0m17:23:19.825513 [debug] [MainThread]: Command `dbt deps` failed at 17:23:19.825362 after 0.09 seconds
[0m17:23:19.825969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7881f328e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7881ef0bf440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7881ef386c60>]}
[0m17:23:19.826467 [debug] [MainThread]: Flushing usage events
[0m17:23:19.832548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:06.010142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707911089430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707910d90470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079106fd940>]}


[0m17:39:39.369514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703db0e00740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703db05269f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703db1094a40>]}


============================== 17:39:39.382915 | 43df2d36-aba1-428d-b3db-0abc1dd624eb ==============================
[0m17:39:39.382915 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:39:39.384360 [debug] [MainThread]: running dbt with arguments {'log_path': 'logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False'}
[0m17:39:39.387652 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:39:39.395949 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.20392431, "process_in_blocks": "0", "process_kernel_time": 0.839873, "process_mem_max_rss": "103620", "process_out_blocks": "3224", "process_user_time": 4.223713}
[0m17:39:39.397207 [debug] [MainThread]: Command `dbt deps` failed at 17:39:39.397007 after 0.21 seconds
[0m17:39:39.398175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703db05269f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703db06fad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703dafb991f0>]}
[0m17:39:39.400578 [debug] [MainThread]: Flushing usage events
[0m17:39:39.882542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:18.482808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4843f1d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d48447b6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4843f1d400>]}


============================== 17:43:18.495306 | 713d0eff-0095-414f-b22f-a1bf21e3c417 ==============================
[0m17:43:18.495306 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:43:18.496418 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'empty': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'write_json': 'True'}
[0m17:43:18.498217 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:43:18.500436 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.110246986, "process_in_blocks": "224", "process_kernel_time": 1.86599, "process_mem_max_rss": "103480", "process_out_blocks": "3224", "process_user_time": 3.88748}
[0m17:43:18.501589 [debug] [MainThread]: Command `dbt deps` failed at 17:43:18.501391 after 0.11 seconds
[0m17:43:18.502475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d48444f9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d48444c8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d48437608f0>]}
[0m17:43:18.503400 [debug] [MainThread]: Flushing usage events
[0m17:43:19.189407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:51.264537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab792d14440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab792e857c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab7929f8bc0>]}


============================== 17:44:51.276982 | ed007b8c-ed8b-49f6-a13b-267a46025b58 ==============================
[0m17:44:51.276982 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:44:51.278680 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'printer_width': '80', 'log_path': 'logs', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True'}
[0m17:44:51.281112 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m17:44:51.283274 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.15965319, "process_in_blocks": "0", "process_kernel_time": 1.118363, "process_mem_max_rss": "103796", "process_out_blocks": "3224", "process_user_time": 4.429519}
[0m17:44:51.284744 [debug] [MainThread]: Command `dbt deps` failed at 17:44:51.284332 after 0.16 seconds
[0m17:44:51.286076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab792f17320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab7953a9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab792588b60>]}
[0m17:44:51.287098 [debug] [MainThread]: Flushing usage events
[0m17:44:51.715697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:15.457109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c602eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c4c7fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c4c7fd60>]}


============================== 18:03:15.462973 | dfcc02ac-95f7-4784-aa00-4a6410742fbe ==============================
[0m18:03:15.462973 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:03:15.464354 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/usr/app/dbt/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/app/dbt', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None'}
[0m18:03:15.577689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfcc02ac-95f7-4784-aa00-4a6410742fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c88f4430>]}
[0m18:03:15.589727 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:03:15.592799 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:03:15.594333 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.24194969, "process_in_blocks": "0", "process_kernel_time": 0.111046, "process_mem_max_rss": "98060", "process_out_blocks": "0", "process_user_time": 1.63001}
[0m18:03:15.595432 [debug] [MainThread]: Command `dbt deps` succeeded at 18:03:15.595313 after 0.24 seconds
[0m18:03:15.596371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c602eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c88f4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c16c4bf50c0>]}
[0m18:03:15.597542 [debug] [MainThread]: Flushing usage events
[0m18:03:16.094733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:17.534713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a7ca2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a6ce3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a6ce3ee0>]}


============================== 18:03:17.539271 | 496f5507-6a14-4ce2-99ae-71184fedb7fd ==============================
[0m18:03:17.539271 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:03:17.540479 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt build --target dev', 'partial_parse': 'True', 'log_path': '/usr/app/dbt/logs', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'profiles_dir': '/usr/app/dbt'}
[0m18:03:17.667355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '496f5507-6a14-4ce2-99ae-71184fedb7fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a5f634c0>]}
[0m18:03:17.716794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '496f5507-6a14-4ce2-99ae-71184fedb7fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a75858a0>]}
[0m18:03:17.718344 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:03:17.770227 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m18:03:17.854055 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:03:17.855776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '496f5507-6a14-4ce2-99ae-71184fedb7fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a75285e0>]}
[0m18:03:18.826426 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:03:18.827755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '496f5507-6a14-4ce2-99ae-71184fedb7fd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a1a792d0>]}
[0m18:03:18.929139 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_911_analytics.stg_nyc_911_calls' (models/staging/stg_nyc_911_calls.sql) depends on a source named 'raw_nyc_data.emergency_calls' which was not found
[0m18:03:18.930843 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:18.932565 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4663557, "process_in_blocks": "0", "process_kernel_time": 0.133109, "process_mem_max_rss": "118148", "process_out_blocks": "0", "process_user_time": 2.351602}
[0m18:03:18.933551 [debug] [MainThread]: Command `dbt build` failed at 18:03:18.933447 after 1.47 seconds
[0m18:03:18.934293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a7ca2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a1b43df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3a1bbe380>]}
[0m18:03:18.935283 [debug] [MainThread]: Flushing usage events
[0m18:03:19.480888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:57.774288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0435a66a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04347bfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04347bfca0>]}


============================== 18:08:57.779093 | d9b7af3f-5b50-4dd1-b025-54e081cc7fa1 ==============================
[0m18:08:57.779093 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:08:57.780702 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False', 'profiles_dir': '/usr/app/dbt', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'empty': 'None'}
[0m18:08:57.789254 [info ] [MainThread]: dbt version: 1.10.15
[0m18:08:57.790349 [info ] [MainThread]: python version: 3.10.19
[0m18:08:57.791309 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m18:08:57.792385 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m18:08:57.841084 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:08:57.843537 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:08:57.845456 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:08:57.846784 [info ] [MainThread]: adapter type: postgres
[0m18:08:57.848208 [info ] [MainThread]: adapter version: 1.9.1
[0m18:08:57.933810 [info ] [MainThread]: Configuration:
[0m18:08:57.936902 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:08:57.938717 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:08:57.939894 [info ] [MainThread]: Required dependencies:
[0m18:08:57.941430 [debug] [MainThread]: Executing "git --help"
[0m18:08:57.944553 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:08:57.946241 [debug] [MainThread]: STDERR: "b''"
[0m18:08:57.948180 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:08:57.950588 [info ] [MainThread]: Connection:
[0m18:08:57.952352 [info ] [MainThread]:   host: localhost
[0m18:08:57.954681 [info ] [MainThread]:   port: 5432
[0m18:08:57.956964 [info ] [MainThread]:   user: tu_usuario
[0m18:08:57.958250 [info ] [MainThread]:   database: new_york
[0m18:08:57.960330 [info ] [MainThread]:   schema: public
[0m18:08:57.962403 [info ] [MainThread]:   connect_timeout: 10
[0m18:08:57.963650 [info ] [MainThread]:   role: None
[0m18:08:57.965682 [info ] [MainThread]:   search_path: None
[0m18:08:57.968170 [info ] [MainThread]:   keepalives_idle: 0
[0m18:08:57.970481 [info ] [MainThread]:   sslmode: None
[0m18:08:57.973675 [info ] [MainThread]:   sslcert: None
[0m18:08:57.975418 [info ] [MainThread]:   sslkey: None
[0m18:08:57.977259 [info ] [MainThread]:   sslrootcert: None
[0m18:08:57.978893 [info ] [MainThread]:   application_name: dbt
[0m18:08:57.980652 [info ] [MainThread]:   retries: 1
[0m18:08:57.983106 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:08:58.025370 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:08:58.042990 [debug] [MainThread]: Using postgres connection "debug"
[0m18:08:58.045080 [debug] [MainThread]: On debug: select 1 as id
[0m18:08:58.046499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:58.049077 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m18:08:58.052211 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m18:08:58.054555 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m18:08:58.055671 [debug] [MainThread]: On debug: No close available on handle
[0m18:08:58.056579 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:08:58.058006 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:08:58.059027 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:08:58.060745 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3594745, "process_in_blocks": "0", "process_kernel_time": 0.097514, "process_mem_max_rss": "110812", "process_out_blocks": "0", "process_user_time": 1.344886}
[0m18:08:58.062316 [debug] [MainThread]: Command `dbt debug` failed at 18:08:58.062220 after 0.36 seconds
[0m18:08:58.063366 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:08:58.064589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0435a66a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c04356ec130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0434707100>]}
[0m18:08:58.066096 [debug] [MainThread]: Flushing usage events
[0m18:08:58.628166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:10:25.253608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7830b7802aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7830b655fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7830b655fd60>]}


============================== 18:10:25.258843 | 1e658fb1-b90e-4bc4-ae66-e5f02ced213f ==============================
[0m18:10:25.258843 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:10:25.260524 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False'}
[0m18:10:25.269630 [info ] [MainThread]: dbt version: 1.10.15
[0m18:10:25.271041 [info ] [MainThread]: python version: 3.10.19
[0m18:10:25.272135 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m18:10:25.273573 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m18:10:25.333326 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:10:25.335285 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:10:25.336596 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:10:25.338264 [info ] [MainThread]: adapter type: postgres
[0m18:10:25.339811 [info ] [MainThread]: adapter version: 1.9.1
[0m18:10:25.427494 [info ] [MainThread]: Configuration:
[0m18:10:25.429810 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:10:25.431344 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:10:25.433056 [info ] [MainThread]: Required dependencies:
[0m18:10:25.435619 [debug] [MainThread]: Executing "git --help"
[0m18:10:25.439096 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:10:25.440702 [debug] [MainThread]: STDERR: "b''"
[0m18:10:25.442355 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:10:25.444068 [info ] [MainThread]: Connection:
[0m18:10:25.444989 [info ] [MainThread]:   host: database
[0m18:10:25.447058 [info ] [MainThread]:   port: 5432
[0m18:10:25.448402 [info ] [MainThread]:   user: postgres
[0m18:10:25.449585 [info ] [MainThread]:   database: new_york
[0m18:10:25.450753 [info ] [MainThread]:   schema: public
[0m18:10:25.451681 [info ] [MainThread]:   connect_timeout: 10
[0m18:10:25.453424 [info ] [MainThread]:   role: None
[0m18:10:25.454403 [info ] [MainThread]:   search_path: None
[0m18:10:25.455646 [info ] [MainThread]:   keepalives_idle: 0
[0m18:10:25.457238 [info ] [MainThread]:   sslmode: None
[0m18:10:25.458152 [info ] [MainThread]:   sslcert: None
[0m18:10:25.459693 [info ] [MainThread]:   sslkey: None
[0m18:10:25.461302 [info ] [MainThread]:   sslrootcert: None
[0m18:10:25.462561 [info ] [MainThread]:   application_name: dbt
[0m18:10:25.464124 [info ] [MainThread]:   retries: 1
[0m18:10:25.465358 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:10:25.505938 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:10:25.523061 [debug] [MainThread]: Using postgres connection "debug"
[0m18:10:25.525051 [debug] [MainThread]: On debug: select 1 as id
[0m18:10:25.526982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:29.530633 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "database" to address: No address associated with hostname

[0m18:10:33.374027 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m18:10:33.375218 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m18:10:33.376879 [debug] [MainThread]: On debug: No close available on handle
[0m18:10:33.377795 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:10:33.381428 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:10:33.383688 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "database" to address: Name or service not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:10:33.386376 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 8.208076, "process_in_blocks": "0", "process_kernel_time": 0.147787, "process_mem_max_rss": "109972", "process_out_blocks": "0", "process_user_time": 1.290143}
[0m18:10:33.388506 [debug] [MainThread]: Command `dbt debug` failed at 18:10:33.388400 after 8.21 seconds
[0m18:10:33.389359 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:10:33.390095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7830b7802aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7830b64a60b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7830b5b38280>]}
[0m18:10:33.392921 [debug] [MainThread]: Flushing usage events
[0m18:10:34.062556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:16.877148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d277beea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d276c33d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d276c33ca0>]}


============================== 18:11:16.882792 | 45515552-966c-4bb0-9f14-6ff064976302 ==============================
[0m18:11:16.882792 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:11:16.885178 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80', 'profiles_dir': '/usr/app/dbt', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'static_parser': 'True', 'quiet': 'False'}
[0m18:11:16.894072 [info ] [MainThread]: dbt version: 1.10.15
[0m18:11:16.895548 [info ] [MainThread]: python version: 3.10.19
[0m18:11:16.899384 [info ] [MainThread]: python path: /usr/local/bin/python3.10
[0m18:11:16.900681 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m18:11:16.967127 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:11:16.968710 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:11:16.969925 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:11:16.971335 [info ] [MainThread]: adapter type: postgres
[0m18:11:16.972372 [info ] [MainThread]: adapter version: 1.9.1
[0m18:11:17.052908 [info ] [MainThread]: Configuration:
[0m18:11:17.054714 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:11:17.056649 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:11:17.058247 [info ] [MainThread]: Required dependencies:
[0m18:11:17.060013 [debug] [MainThread]: Executing "git --help"
[0m18:11:17.064004 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:11:17.065230 [debug] [MainThread]: STDERR: "b''"
[0m18:11:17.066063 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:11:17.067753 [info ] [MainThread]: Connection:
[0m18:11:17.068996 [info ] [MainThread]:   host: db
[0m18:11:17.072422 [info ] [MainThread]:   port: 5432
[0m18:11:17.073859 [info ] [MainThread]:   user: postgres
[0m18:11:17.075391 [info ] [MainThread]:   database: new_york
[0m18:11:17.076589 [info ] [MainThread]:   schema: public
[0m18:11:17.079380 [info ] [MainThread]:   connect_timeout: 10
[0m18:11:17.080837 [info ] [MainThread]:   role: None
[0m18:11:17.082053 [info ] [MainThread]:   search_path: None
[0m18:11:17.083503 [info ] [MainThread]:   keepalives_idle: 0
[0m18:11:17.084897 [info ] [MainThread]:   sslmode: None
[0m18:11:17.088928 [info ] [MainThread]:   sslcert: None
[0m18:11:17.090467 [info ] [MainThread]:   sslkey: None
[0m18:11:17.092041 [info ] [MainThread]:   sslrootcert: None
[0m18:11:17.093455 [info ] [MainThread]:   application_name: dbt
[0m18:11:17.094587 [info ] [MainThread]:   retries: 1
[0m18:11:17.095817 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:11:17.139584 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:11:17.157367 [debug] [MainThread]: Using postgres connection "debug"
[0m18:11:17.159167 [debug] [MainThread]: On debug: select 1 as id
[0m18:11:17.160862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:17.169525 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m18:11:17.171203 [debug] [MainThread]: On debug: Close
[0m18:11:17.172667 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:11:17.174051 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:11:17.175420 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3668096, "process_in_blocks": "0", "process_kernel_time": 0.171416, "process_mem_max_rss": "112028", "process_out_blocks": "0", "process_user_time": 1.347415}
[0m18:11:17.176493 [debug] [MainThread]: Command `dbt debug` succeeded at 18:11:17.176400 after 0.37 seconds
[0m18:11:17.177482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:11:17.178403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d277beea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d275b109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d275b430a0>]}
[0m18:11:17.179408 [debug] [MainThread]: Flushing usage events
[0m18:11:17.890382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:35.008672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac98f6a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac8663b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac8663ac0>]}


============================== 18:15:35.015227 | b8ab23f1-b333-4ccf-850c-73936c4d9c7a ==============================
[0m18:15:35.015227 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:15:35.017049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/usr/app/dbt', 'invocation_command': 'dbt run', 'empty': 'False', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None'}
[0m18:15:35.201580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ab23f1-b333-4ccf-850c-73936c4d9c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac8882650>]}
[0m18:15:35.249296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ab23f1-b333-4ccf-850c-73936c4d9c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac7cbae60>]}
[0m18:15:35.251979 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:15:35.318937 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:15:35.380553 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:15:35.382318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8ab23f1-b333-4ccf-850c-73936c4d9c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac8eba7d0>]}
[0m18:15:36.480066 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:15:36.481703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b8ab23f1-b333-4ccf-850c-73936c4d9c7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78babf35d2a0>]}
[0m18:15:36.580513 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_911_analytics.stg_nyc_911_calls' (models/staging/stg_nyc_911_calls.sql) depends on a source named 'raw_nyc_data.emergency_calls' which was not found
[0m18:15:36.583518 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:15:36.588661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.641626, "process_in_blocks": "78496", "process_kernel_time": 0.207651, "process_mem_max_rss": "118028", "process_out_blocks": "0", "process_user_time": 2.414457}
[0m18:15:36.594412 [debug] [MainThread]: Command `dbt run` failed at 18:15:36.594308 after 1.65 seconds
[0m18:15:36.598089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac98f6a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac99b1c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bac4123bb0>]}
[0m18:15:36.606210 [debug] [MainThread]: Flushing usage events
[0m18:15:37.514159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:50.628971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa7b0eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa687bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa687bbe0>]}


============================== 18:17:50.636443 | ee0b0cc2-3a6e-4e3c-96bb-657a943280c0 ==============================
[0m18:17:50.636443 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:17:50.638226 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/app/dbt/logs', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/app/dbt', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m18:17:50.820923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa5ed31c0>]}
[0m18:17:50.867023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa5ed3190>]}
[0m18:17:50.870093 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:17:50.937792 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:17:51.003715 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:17:51.005886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa70cc850>]}
[0m18:17:52.007102 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:17:52.011725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa16492d0>]}
[0m18:17:52.316664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa151ee90>]}
[0m18:17:52.470386 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:17:52.484352 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:17:52.526321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa16489a0>]}
[0m18:17:52.528649 [info ] [MainThread]: Found 2 models, 1 seed, 7 data tests, 1 source, 434 macros
[0m18:17:52.531139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa1648640>]}
[0m18:17:52.535461 [info ] [MainThread]: 
[0m18:17:52.537922 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:17:52.540269 [info ] [MainThread]: 
[0m18:17:52.542598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:52.549873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:17:52.551028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:17:52.598650 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:17:52.599002 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:17:52.599810 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:17:52.600737 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:17:52.601764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:52.602602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:52.628736 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m18:17:52.629126 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m18:17:52.630854 [debug] [ThreadPool]: On list_new_york: Close
[0m18:17:52.632490 [debug] [ThreadPool]: On list_new_york: Close
[0m18:17:52.634874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now create_new_york_public_analytics)
[0m18:17:52.635205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now create_new_york_public_staging)
[0m18:17:52.636048 [debug] [ThreadPool]: Creating schema "database: "new_york"
schema: "public_analytics"
"
[0m18:17:52.637421 [debug] [ThreadPool]: Creating schema "database: "new_york"
schema: "public_staging"
"
[0m18:17:52.642072 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_analytics"
[0m18:17:52.644701 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_staging"
[0m18:17:52.645919 [debug] [ThreadPool]: On create_new_york_public_analytics: BEGIN
[0m18:17:52.647116 [debug] [ThreadPool]: On create_new_york_public_staging: BEGIN
[0m18:17:52.648411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:52.649511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:52.656023 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:17:52.656695 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:17:52.657386 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_analytics"
[0m18:17:52.658705 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_staging"
[0m18:17:52.659863 [debug] [ThreadPool]: On create_new_york_public_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "create_new_york_public_analytics"} */
create schema if not exists "public_analytics"
[0m18:17:52.660983 [debug] [ThreadPool]: On create_new_york_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "create_new_york_public_staging"} */
create schema if not exists "public_staging"
[0m18:17:52.664398 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:17:52.664643 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m18:17:52.665918 [debug] [ThreadPool]: On create_new_york_public_staging: COMMIT
[0m18:17:52.667495 [debug] [ThreadPool]: On create_new_york_public_analytics: COMMIT
[0m18:17:52.668533 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_staging"
[0m18:17:52.669567 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_analytics"
[0m18:17:52.670603 [debug] [ThreadPool]: On create_new_york_public_staging: COMMIT
[0m18:17:52.671599 [debug] [ThreadPool]: On create_new_york_public_analytics: COMMIT
[0m18:17:52.674525 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:17:52.675448 [debug] [ThreadPool]: On create_new_york_public_staging: Close
[0m18:17:52.675885 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:17:52.677511 [debug] [ThreadPool]: On create_new_york_public_analytics: Close
[0m18:17:52.679925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_new_york_public_staging, now list_new_york_public_analytics)
[0m18:17:52.680373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_new_york_public_analytics, now list_new_york_public)
[0m18:17:52.680892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york_public_staging'
[0m18:17:52.685487 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:17:52.689230 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:17:52.694316 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:17:52.698202 [debug] [ThreadPool]: On list_new_york_public_analytics: BEGIN
[0m18:17:52.699457 [debug] [ThreadPool]: On list_new_york_public: BEGIN
[0m18:17:52.700799 [debug] [ThreadPool]: On list_new_york_public_staging: BEGIN
[0m18:17:52.701987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:52.703053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:52.704353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:52.711287 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:17:52.712485 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:17:52.712745 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:17:52.713215 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:17:52.714152 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:17:52.716117 [debug] [ThreadPool]: On list_new_york_public_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_analytics"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:17:52.717558 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:17:52.718762 [debug] [ThreadPool]: On list_new_york_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_staging"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:17:52.723314 [debug] [ThreadPool]: On list_new_york_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:17:52.734243 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.014 seconds
[0m18:17:52.735104 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m18:17:52.736095 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m18:17:52.739129 [debug] [ThreadPool]: On list_new_york_public_analytics: ROLLBACK
[0m18:17:52.742637 [debug] [ThreadPool]: On list_new_york_public_staging: ROLLBACK
[0m18:17:52.745289 [debug] [ThreadPool]: On list_new_york_public: ROLLBACK
[0m18:17:52.746644 [debug] [ThreadPool]: On list_new_york_public_analytics: Close
[0m18:17:52.747899 [debug] [ThreadPool]: On list_new_york_public_staging: Close
[0m18:17:52.749404 [debug] [ThreadPool]: On list_new_york_public: Close
[0m18:17:52.758114 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.759450 [debug] [MainThread]: On master: BEGIN
[0m18:17:52.760620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:52.766381 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:17:52.767582 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.768910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:17:52.778988 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m18:17:52.780635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa4f19ae0>]}
[0m18:17:52.781921 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:52.783807 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.784810 [debug] [MainThread]: On master: BEGIN
[0m18:17:52.786718 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:17:52.788093 [debug] [MainThread]: On master: COMMIT
[0m18:17:52.789065 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:52.790316 [debug] [MainThread]: On master: COMMIT
[0m18:17:52.791781 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:17:52.792873 [debug] [MainThread]: On master: Close
[0m18:17:52.798386 [debug] [Thread-1 (]: Began running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:17:52.799864 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_nyc_911_calls ................... [RUN]
[0m18:17:52.801246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_new_york_public, now model.nyc_911_analytics.stg_nyc_911_calls)
[0m18:17:52.802215 [debug] [Thread-1 (]: Began compiling node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:17:52.808166 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.829944 [debug] [Thread-1 (]: Began executing node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:17:52.854093 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.869784 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.870616 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: BEGIN
[0m18:17:52.871458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:52.877319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:17:52.878735 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.879551 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */

  create view "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp"
    
    
  as (
    with source as (

    select * from "new_york"."public"."emergency_calls"

),

renamed as (

    select
        -- IDs y Claves
        cad_evnt_id as event_id,
        
        -- Fechas y Tiempos
        create_date as created_at,
        incident_date,
        incident_time, -- Podrías intentar combinarlos si incident_date no tiene hora
        add_ts as added_at,
        disp_ts as dispatched_at,
        arrivd_ts as arrived_at,
        closng_ts as closed_at,

        -- Detalles del Incidente
        typ_desc as incident_type_description,
        radio_code,
        cip_jobs as job_status, -- Critical Injury / Police jobs
        
        -- Ubicación
        boro_nm as borough,
        patrl_boro_nm as patrol_borough,
        nypd_pct_cd as precinct_id,
        latitude,
        longitude,
        geo_cd_x,
        geo_cd_y

    from source

)

select * from renamed
  );
[0m18:17:52.894276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m18:17:52.899581 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.900633 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp" rename to "stg_nyc_911_calls"
[0m18:17:52.902280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:17:52.912464 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:17:52.913317 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.914469 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:17:52.919062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:17:52.924073 [debug] [Thread-1 (]: Applying DROP to: "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup"
[0m18:17:52.927739 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:17:52.929200 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
drop view if exists "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup" cascade
[0m18:17:52.931002 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:17:52.933285 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: Close
[0m18:17:52.935786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794faaee8940>]}
[0m18:17:52.937255 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_nyc_911_calls .............. [[32mCREATE VIEW[0m in 0.13s]
[0m18:17:52.938526 [debug] [Thread-1 (]: Finished running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:17:52.939710 [debug] [Thread-3 (]: Began running node model.nyc_911_analytics.fct_incidents
[0m18:17:52.940549 [info ] [Thread-3 (]: 2 of 2 START sql table model public_analytics.fct_incidents .................... [RUN]
[0m18:17:52.942167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_new_york_public_analytics, now model.nyc_911_analytics.fct_incidents)
[0m18:17:52.942949 [debug] [Thread-3 (]: Began compiling node model.nyc_911_analytics.fct_incidents
[0m18:17:52.945796 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_911_analytics.fct_incidents"
[0m18:17:52.956024 [debug] [Thread-3 (]: Began executing node model.nyc_911_analytics.fct_incidents
[0m18:17:52.972362 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_911_analytics.fct_incidents"
[0m18:17:53.000882 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:17:53.001856 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: BEGIN
[0m18:17:53.002743 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:17:53.008696 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m18:17:53.009673 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:17:53.011519 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */

  
    

  create  table "new_york"."public_analytics"."fct_incidents__dbt_tmp"
  
  
    as
  
  (
    with staging as (
    
    select * from "new_york"."public_staging"."stg_nyc_911_calls"
),

centroids as (

    select * from "new_york"."public"."borough_centroids"

),

-- 1. Separamos los datos que YA tienen barrio
data_with_borough as (
    
    select * from staging 
    where borough is not null

),

-- 2. Separamos los datos que NO tienen barrio (NULL)
data_missing_borough as (
    
    select * from staging 
    where borough is null 
      and latitude is not null -- Solo podemos arreglar si tenemos coordenadas

),

-- 3. Magia: Cruzamos los nulos con los 5 centroides y calculamos la distancia
calculated_boroughs as (
    
    select 
        incident.event_id,
        centroid.borough_name as imputed_borough,
        -- Fórmula de distancia simple (Pitagoras) para encontrar el más cercano
        (power(incident.latitude - centroid.centroid_lat, 2) + 
         power(incident.longitude - centroid.centroid_lon, 2)) as distance_squared
    from data_missing_borough incident
    cross join centroids centroid

),

-- 4. Nos quedamos solo con el barrio más cercano para cada incidente
closest_match as (
    
    select distinct on (event_id)
        event_id,
        imputed_borough
    from calculated_boroughs
    order by event_id, distance_squared asc

),

-- 5. Unimos todo de nuevo
final_combined as (

    -- Filas originales que estaban bien
    select 
        event_id,
        incident_type_description,
        borough,
        dispatched_at, -- Necesarios para cálculo, luego los quitamos
        arrived_at,
        created_at,
        closed_at,
        latitude,
        longitude
    from data_with_borough

    union all

    -- Filas reparadas (unimos la data original con el barrio calculado)
    select 
        m.event_id,
        m.incident_type_description,
        c.imputed_borough as borough, -- Aquí usamos el barrio calculado
        m.dispatched_at,
        m.arrived_at,
        m.created_at,
        m.closed_at,
        m.latitude,
        m.longitude
    from data_missing_borough m
    join closest_match c on m.event_id = c.event_id

),

metrics as (

    select
        event_id,
        incident_type_description,
        borough,
        
        -- Cálculos (usamos las fechas aquí antes de descartarlas)
        extract(epoch from (arrived_at - dispatched_at)) / 60 as response_time_minutes,
        extract(epoch from (closed_at - created_at)) / 60 as total_duration_minutes,

        latitude,
        longitude

    from final_combined
    -- Filtros de limpieza
    where dispatched_at is not null 
      and arrived_at is not null

)

-- Selección final: Aquí EXCLUIMOS precinct_id, created_at y arrived_at como pediste
select 
    event_id,
    incident_type_description,
    borough,
    response_time_minutes,
    total_duration_minutes,
    latitude,
    longitude
from metrics
  );
  
[0m18:17:53.014565 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.borough_centroids" does not exist
LINE 19:     select * from "new_york"."public"."borough_centroids"
                           ^

[0m18:17:53.015245 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: ROLLBACK
[0m18:17:53.016098 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: Close
[0m18:17:53.024368 [debug] [Thread-3 (]: Database Error in model fct_incidents (models/marts/fct_incidents.sql)
  relation "public.borough_centroids" does not exist
  LINE 19:     select * from "new_york"."public"."borough_centroids"
                             ^
  compiled code at target/run/nyc_911_analytics/models/marts/fct_incidents.sql
[0m18:17:53.025437 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0b0cc2-3a6e-4e3c-96bb-657a943280c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa436a3b0>]}
[0m18:17:53.026458 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model public_analytics.fct_incidents ........... [[31mERROR[0m in 0.08s]
[0m18:17:53.027557 [debug] [Thread-3 (]: Finished running node model.nyc_911_analytics.fct_incidents
[0m18:17:53.028558 [debug] [Thread-7 (]: Marking all children of 'model.nyc_911_analytics.fct_incidents' to be skipped because of status 'error'.  Reason: Database Error in model fct_incidents (models/marts/fct_incidents.sql)
  relation "public.borough_centroids" does not exist
  LINE 19:     select * from "new_york"."public"."borough_centroids"
                             ^
  compiled code at target/run/nyc_911_analytics/models/marts/fct_incidents.sql.
[0m18:17:53.030505 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:53.031505 [debug] [MainThread]: On master: BEGIN
[0m18:17:53.032218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:53.038203 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:17:53.039403 [debug] [MainThread]: On master: COMMIT
[0m18:17:53.040339 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:53.041083 [debug] [MainThread]: On master: COMMIT
[0m18:17:53.042019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:17:53.042698 [debug] [MainThread]: On master: Close
[0m18:17:53.043636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:53.044304 [debug] [MainThread]: Connection 'model.nyc_911_analytics.fct_incidents' was properly closed.
[0m18:17:53.044933 [debug] [MainThread]: Connection 'model.nyc_911_analytics.stg_nyc_911_calls' was properly closed.
[0m18:17:53.045673 [debug] [MainThread]: Connection 'list_new_york_public_staging' was properly closed.
[0m18:17:53.046307 [info ] [MainThread]: 
[0m18:17:53.047128 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m18:17:53.048216 [debug] [MainThread]: Command end result
[0m18:17:53.077751 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:17:53.107851 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:17:53.120698 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m18:17:53.128177 [info ] [MainThread]: 
[0m18:17:53.130379 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:17:53.131558 [info ] [MainThread]: 
[0m18:17:53.134949 [error] [MainThread]: [31mFailure in model fct_incidents (models/marts/fct_incidents.sql)[0m
[0m18:17:53.136884 [error] [MainThread]:   Database Error in model fct_incidents (models/marts/fct_incidents.sql)
  relation "public.borough_centroids" does not exist
  LINE 19:     select * from "new_york"."public"."borough_centroids"
                             ^
  compiled code at target/run/nyc_911_analytics/models/marts/fct_incidents.sql
[0m18:17:53.138368 [info ] [MainThread]: 
[0m18:17:53.140044 [info ] [MainThread]:   compiled code at target/compiled/nyc_911_analytics/models/marts/fct_incidents.sql
[0m18:17:53.142281 [info ] [MainThread]: 
[0m18:17:53.147692 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m18:17:53.148919 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:17:53.154260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6046052, "process_in_blocks": "87544", "process_kernel_time": 0.25515, "process_mem_max_rss": "130248", "process_out_blocks": "0", "process_user_time": 2.870441}
[0m18:17:53.156233 [debug] [MainThread]: Command `dbt run` failed at 18:17:53.156022 after 2.61 seconds
[0m18:17:53.157403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa7b0eaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa5ed2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794fa779a230>]}
[0m18:17:53.158844 [debug] [MainThread]: Flushing usage events
[0m18:17:53.977837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:32.251422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cc832ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cb772c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cb772cb0>]}


============================== 18:19:32.263336 | 83f66af8-df6e-445b-b16a-6130a1993c7b ==============================
[0m18:19:32.263336 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:19:32.266994 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/usr/app/dbt', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt seed', 'version_check': 'True', 'introspect': 'True'}
[0m18:19:32.499941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cf4144f0>]}
[0m18:19:32.547092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cb98c040>]}
[0m18:19:32.550695 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:19:32.615801 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:19:32.948988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:32.951105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:33.000529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286ca502b00>]}
[0m18:19:33.119466 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:19:33.135209 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:19:33.233023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286c9982a70>]}
[0m18:19:33.235435 [info ] [MainThread]: Found 2 models, 1 seed, 7 data tests, 1 source, 434 macros
[0m18:19:33.237387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286c9982b30>]}
[0m18:19:33.240348 [info ] [MainThread]: 
[0m18:19:33.242367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:33.243728 [info ] [MainThread]: 
[0m18:19:33.244919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:33.246927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:19:33.285244 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:19:33.287517 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:19:33.289876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:33.314557 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m18:19:33.317355 [debug] [ThreadPool]: On list_new_york: Close
[0m18:19:33.320203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public)
[0m18:19:33.320796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york_public_staging'
[0m18:19:33.321640 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york_public_analytics'
[0m18:19:33.326377 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:19:33.329156 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:19:33.332203 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:19:33.333599 [debug] [ThreadPool]: On list_new_york_public: BEGIN
[0m18:19:33.334774 [debug] [ThreadPool]: On list_new_york_public_staging: BEGIN
[0m18:19:33.335915 [debug] [ThreadPool]: On list_new_york_public_analytics: BEGIN
[0m18:19:33.337319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:33.339035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:33.340937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:33.352506 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:19:33.355042 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m18:19:33.355651 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:19:33.356267 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:19:33.358058 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:19:33.359658 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:19:33.361406 [debug] [ThreadPool]: On list_new_york_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:19:33.362963 [debug] [ThreadPool]: On list_new_york_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_staging"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:19:33.364607 [debug] [ThreadPool]: On list_new_york_public_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_analytics"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:19:33.372252 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m18:19:33.374110 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m18:19:33.375085 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m18:19:33.376037 [debug] [ThreadPool]: On list_new_york_public: ROLLBACK
[0m18:19:33.378269 [debug] [ThreadPool]: On list_new_york_public_analytics: ROLLBACK
[0m18:19:33.380315 [debug] [ThreadPool]: On list_new_york_public_staging: ROLLBACK
[0m18:19:33.381816 [debug] [ThreadPool]: On list_new_york_public: Close
[0m18:19:33.382929 [debug] [ThreadPool]: On list_new_york_public_analytics: Close
[0m18:19:33.384060 [debug] [ThreadPool]: On list_new_york_public_staging: Close
[0m18:19:33.392085 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:33.393604 [debug] [MainThread]: On master: BEGIN
[0m18:19:33.394770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:33.401026 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:19:33.402481 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:33.403760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:19:33.409641 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m18:19:33.411855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286c9547bb0>]}
[0m18:19:33.413151 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:33.414481 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:33.415557 [debug] [MainThread]: On master: BEGIN
[0m18:19:33.416800 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:19:33.417838 [debug] [MainThread]: On master: COMMIT
[0m18:19:33.418833 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:33.419915 [debug] [MainThread]: On master: COMMIT
[0m18:19:33.421399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:33.422503 [debug] [MainThread]: On master: Close
[0m18:19:33.427720 [debug] [Thread-1 (]: Began running node seed.nyc_911_analytics.borough_centroids
[0m18:19:33.429393 [info ] [Thread-1 (]: 1 of 1 START seed file public.borough_centroids ................................ [RUN]
[0m18:19:33.431301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_new_york_public_staging, now seed.nyc_911_analytics.borough_centroids)
[0m18:19:33.433431 [debug] [Thread-1 (]: Began compiling node seed.nyc_911_analytics.borough_centroids
[0m18:19:33.435347 [debug] [Thread-1 (]: Began executing node seed.nyc_911_analytics.borough_centroids
[0m18:19:33.467399 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:19:33.469228 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: BEGIN
[0m18:19:33.470830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:33.477170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:19:33.478653 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:19:33.479875 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "seed.nyc_911_analytics.borough_centroids"} */

    create table "new_york"."public"."borough_centroids" ("borough_name" text,"centroid_lat" float8,"centroid_lon" float8)
  
[0m18:19:33.486283 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m18:19:33.497638 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:19:33.499287 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: 
          insert into "new_york"."public"."borough_centroids" ("borough_name", "centroid_lat", "centroid_lon") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:19:33.501576 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m18:19:33.506777 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.nyc_911_analytics.borough_centroids"
[0m18:19:33.541282 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: COMMIT
[0m18:19:33.542889 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:19:33.543971 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: COMMIT
[0m18:19:33.549605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:19:33.552568 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: Close
[0m18:19:33.555971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f66af8-df6e-445b-b16a-6130a1993c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cfd70f10>]}
[0m18:19:33.557571 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.borough_centroids ............................ [[32mINSERT 5[0m in 0.12s]
[0m18:19:33.559283 [debug] [Thread-1 (]: Finished running node seed.nyc_911_analytics.borough_centroids
[0m18:19:33.561760 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:33.563137 [debug] [MainThread]: On master: BEGIN
[0m18:19:33.564379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:33.570600 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:19:33.572067 [debug] [MainThread]: On master: COMMIT
[0m18:19:33.573429 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:33.574489 [debug] [MainThread]: On master: COMMIT
[0m18:19:33.575870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:33.577415 [debug] [MainThread]: On master: Close
[0m18:19:33.578849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:33.580500 [debug] [MainThread]: Connection 'list_new_york_public' was properly closed.
[0m18:19:33.582054 [debug] [MainThread]: Connection 'seed.nyc_911_analytics.borough_centroids' was properly closed.
[0m18:19:33.583577 [debug] [MainThread]: Connection 'list_new_york_public_analytics' was properly closed.
[0m18:19:33.585588 [info ] [MainThread]: 
[0m18:19:33.587094 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m18:19:33.588359 [debug] [MainThread]: Command end result
[0m18:19:33.637507 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:19:33.645735 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:19:33.656247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m18:19:33.657297 [info ] [MainThread]: 
[0m18:19:33.658554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:33.659480 [info ] [MainThread]: 
[0m18:19:33.660622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:19:33.663419 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.7139456, "process_in_blocks": "23000", "process_kernel_time": 0.123644, "process_mem_max_rss": "120224", "process_out_blocks": "0", "process_user_time": 1.957699}
[0m18:19:33.664567 [debug] [MainThread]: Command `dbt seed` succeeded at 18:19:33.664476 after 1.72 seconds
[0m18:19:33.665591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cc832ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286ce1e8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286cf4144f0>]}
[0m18:19:33.666665 [debug] [MainThread]: Flushing usage events
[0m18:19:34.296620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:39.730020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f8bc2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f792fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f792fac0>]}


============================== 18:19:39.735135 | 0d1d48fa-c0a6-4f35-9560-e989f84c33ea ==============================
[0m18:19:39.735135 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:19:39.736754 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt', 'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False'}
[0m18:19:39.870874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f7b4e650>]}
[0m18:19:39.916349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f6962e60>]}
[0m18:19:39.917967 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:19:39.974975 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:19:40.242241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:40.244060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:40.292324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f65ceaa0>]}
[0m18:19:40.422137 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:19:40.435512 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:19:40.495837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f5584a60>]}
[0m18:19:40.497574 [info ] [MainThread]: Found 2 models, 1 seed, 7 data tests, 1 source, 434 macros
[0m18:19:40.499352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f5584cd0>]}
[0m18:19:40.502258 [info ] [MainThread]: 
[0m18:19:40.504159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:40.505189 [info ] [MainThread]: 
[0m18:19:40.507571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:40.513576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:19:40.514257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:19:40.543626 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:19:40.543948 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:19:40.545839 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:19:40.547583 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:19:40.549710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:40.551341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:40.561743 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m18:19:40.562028 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m18:19:40.564339 [debug] [ThreadPool]: On list_new_york: Close
[0m18:19:40.566417 [debug] [ThreadPool]: On list_new_york: Close
[0m18:19:40.570698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public)
[0m18:19:40.571083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public_staging)
[0m18:19:40.571554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york_public_analytics'
[0m18:19:40.576415 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:19:40.579370 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:19:40.581789 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:19:40.583250 [debug] [ThreadPool]: On list_new_york_public: BEGIN
[0m18:19:40.584906 [debug] [ThreadPool]: On list_new_york_public_staging: BEGIN
[0m18:19:40.586235 [debug] [ThreadPool]: On list_new_york_public_analytics: BEGIN
[0m18:19:40.587959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:40.589157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:40.590780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:40.597916 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:19:40.598705 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:19:40.599074 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:19:40.599716 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:19:40.600470 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:19:40.601824 [debug] [ThreadPool]: On list_new_york_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:19:40.603661 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:19:40.605372 [debug] [ThreadPool]: On list_new_york_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_staging"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:19:40.607720 [debug] [ThreadPool]: On list_new_york_public_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_analytics"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:19:40.610478 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:19:40.612236 [debug] [ThreadPool]: On list_new_york_public: ROLLBACK
[0m18:19:40.612637 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m18:19:40.613798 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m18:19:40.614915 [debug] [ThreadPool]: On list_new_york_public: Close
[0m18:19:40.616548 [debug] [ThreadPool]: On list_new_york_public_staging: ROLLBACK
[0m18:19:40.618533 [debug] [ThreadPool]: On list_new_york_public_analytics: ROLLBACK
[0m18:19:40.621362 [debug] [ThreadPool]: On list_new_york_public_staging: Close
[0m18:19:40.622391 [debug] [ThreadPool]: On list_new_york_public_analytics: Close
[0m18:19:40.627771 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:40.629055 [debug] [MainThread]: On master: BEGIN
[0m18:19:40.630367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:40.636381 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:19:40.637413 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:40.638809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:19:40.644185 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m18:19:40.646142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f871bf10>]}
[0m18:19:40.647742 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:40.649511 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:40.650707 [debug] [MainThread]: On master: BEGIN
[0m18:19:40.652323 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:19:40.653594 [debug] [MainThread]: On master: COMMIT
[0m18:19:40.654832 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:40.656094 [debug] [MainThread]: On master: COMMIT
[0m18:19:40.657645 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:40.659228 [debug] [MainThread]: On master: Close
[0m18:19:40.663616 [debug] [Thread-1 (]: Began running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:19:40.665300 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.stg_nyc_911_calls ................... [RUN]
[0m18:19:40.666721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_new_york_public_analytics, now model.nyc_911_analytics.stg_nyc_911_calls)
[0m18:19:40.667993 [debug] [Thread-1 (]: Began compiling node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:19:40.674719 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.690900 [debug] [Thread-1 (]: Began executing node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:19:40.715920 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.731813 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.733557 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: BEGIN
[0m18:19:40.735371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:40.741658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:19:40.743192 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.744577 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */

  create view "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp"
    
    
  as (
    with source as (

    select * from "new_york"."public"."emergency_calls"

),

renamed as (

    select
        -- IDs y Claves
        cad_evnt_id as event_id,
        
        -- Fechas y Tiempos
        create_date as created_at,
        incident_date,
        incident_time, -- Podrías intentar combinarlos si incident_date no tiene hora
        add_ts as added_at,
        disp_ts as dispatched_at,
        arrivd_ts as arrived_at,
        closng_ts as closed_at,

        -- Detalles del Incidente
        typ_desc as incident_type_description,
        radio_code,
        cip_jobs as job_status, -- Critical Injury / Police jobs
        
        -- Ubicación
        boro_nm as borough,
        patrl_boro_nm as patrol_borough,
        nypd_pct_cd as precinct_id,
        latitude,
        longitude,
        geo_cd_x,
        geo_cd_y

    from source

)

select * from renamed
  );
[0m18:19:40.751602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:19:40.757635 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.759393 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls" rename to "stg_nyc_911_calls__dbt_backup"
[0m18:19:40.761684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:19:40.765044 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.766544 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp" rename to "stg_nyc_911_calls"
[0m18:19:40.768522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:19:40.781641 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:19:40.783607 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.785146 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:19:40.788912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:19:40.794560 [debug] [Thread-1 (]: Applying DROP to: "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup"
[0m18:19:40.799504 [debug] [Thread-1 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:19:40.801153 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
drop view if exists "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup" cascade
[0m18:19:40.809491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m18:19:40.813661 [debug] [Thread-1 (]: On model.nyc_911_analytics.stg_nyc_911_calls: Close
[0m18:19:40.816720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98efdbae30>]}
[0m18:19:40.818658 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.stg_nyc_911_calls .............. [[32mCREATE VIEW[0m in 0.15s]
[0m18:19:40.820515 [debug] [Thread-1 (]: Finished running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:19:40.822754 [debug] [Thread-3 (]: Began running node model.nyc_911_analytics.fct_incidents
[0m18:19:40.824292 [info ] [Thread-3 (]: 2 of 2 START sql table model public_analytics.fct_incidents .................... [RUN]
[0m18:19:40.826223 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_new_york_public, now model.nyc_911_analytics.fct_incidents)
[0m18:19:40.827507 [debug] [Thread-3 (]: Began compiling node model.nyc_911_analytics.fct_incidents
[0m18:19:40.831737 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.847782 [debug] [Thread-3 (]: Began executing node model.nyc_911_analytics.fct_incidents
[0m18:19:40.865059 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.880230 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.881958 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: BEGIN
[0m18:19:40.884211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:40.891240 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m18:19:40.892641 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.894119 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */

  
    

  create  table "new_york"."public_analytics"."fct_incidents__dbt_tmp"
  
  
    as
  
  (
    with staging as (
    
    select * from "new_york"."public_staging"."stg_nyc_911_calls"
),

centroids as (

    select * from "new_york"."public"."borough_centroids"

),

-- 1. Separamos los datos que YA tienen barrio
data_with_borough as (
    
    select * from staging 
    where borough is not null

),

-- 2. Separamos los datos que NO tienen barrio (NULL)
data_missing_borough as (
    
    select * from staging 
    where borough is null 
      and latitude is not null -- Solo podemos arreglar si tenemos coordenadas

),

-- 3. Magia: Cruzamos los nulos con los 5 centroides y calculamos la distancia
calculated_boroughs as (
    
    select 
        incident.event_id,
        centroid.borough_name as imputed_borough,
        -- Fórmula de distancia simple (Pitagoras) para encontrar el más cercano
        (power(incident.latitude - centroid.centroid_lat, 2) + 
         power(incident.longitude - centroid.centroid_lon, 2)) as distance_squared
    from data_missing_borough incident
    cross join centroids centroid

),

-- 4. Nos quedamos solo con el barrio más cercano para cada incidente
closest_match as (
    
    select distinct on (event_id)
        event_id,
        imputed_borough
    from calculated_boroughs
    order by event_id, distance_squared asc

),

-- 5. Unimos todo de nuevo
final_combined as (

    -- Filas originales que estaban bien
    select 
        event_id,
        incident_type_description,
        borough,
        dispatched_at, -- Necesarios para cálculo, luego los quitamos
        arrived_at,
        created_at,
        closed_at,
        latitude,
        longitude
    from data_with_borough

    union all

    -- Filas reparadas (unimos la data original con el barrio calculado)
    select 
        m.event_id,
        m.incident_type_description,
        c.imputed_borough as borough, -- Aquí usamos el barrio calculado
        m.dispatched_at,
        m.arrived_at,
        m.created_at,
        m.closed_at,
        m.latitude,
        m.longitude
    from data_missing_borough m
    join closest_match c on m.event_id = c.event_id

),

metrics as (

    select
        event_id,
        incident_type_description,
        borough,
        
        -- Cálculos (usamos las fechas aquí antes de descartarlas)
        extract(epoch from (arrived_at - dispatched_at)) / 60 as response_time_minutes,
        extract(epoch from (closed_at - created_at)) / 60 as total_duration_minutes,

        latitude,
        longitude

    from final_combined
    -- Filtros de limpieza
    where dispatched_at is not null 
      and arrived_at is not null

)

-- Selección final: Aquí EXCLUIMOS precinct_id, created_at y arrived_at como pediste
select 
    event_id,
    incident_type_description,
    borough,
    response_time_minutes,
    total_duration_minutes,
    latitude,
    longitude
from metrics
  );
  
[0m18:19:40.906391 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m18:19:40.913579 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.915293 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
alter table "new_york"."public_analytics"."fct_incidents__dbt_tmp" rename to "fct_incidents"
[0m18:19:40.917260 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:19:40.919230 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: COMMIT
[0m18:19:40.920745 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.922300 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: COMMIT
[0m18:19:40.926062 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m18:19:40.928995 [debug] [Thread-3 (]: Applying DROP to: "new_york"."public_analytics"."fct_incidents__dbt_backup"
[0m18:19:40.931966 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:19:40.933425 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
drop table if exists "new_york"."public_analytics"."fct_incidents__dbt_backup" cascade
[0m18:19:40.936766 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:19:40.938938 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: Close
[0m18:19:40.940815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1d48fa-c0a6-4f35-9560-e989f84c33ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98efcef760>]}
[0m18:19:40.943803 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public_analytics.fct_incidents ............... [[32mSELECT 0[0m in 0.11s]
[0m18:19:40.946825 [debug] [Thread-3 (]: Finished running node model.nyc_911_analytics.fct_incidents
[0m18:19:40.950966 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:40.953305 [debug] [MainThread]: On master: BEGIN
[0m18:19:40.955021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:40.965841 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:19:40.967269 [debug] [MainThread]: On master: COMMIT
[0m18:19:40.968979 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:40.970261 [debug] [MainThread]: On master: COMMIT
[0m18:19:40.971601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:40.972858 [debug] [MainThread]: On master: Close
[0m18:19:40.974025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:40.975036 [debug] [MainThread]: Connection 'model.nyc_911_analytics.fct_incidents' was properly closed.
[0m18:19:40.976036 [debug] [MainThread]: Connection 'list_new_york_public_staging' was properly closed.
[0m18:19:40.977035 [debug] [MainThread]: Connection 'model.nyc_911_analytics.stg_nyc_911_calls' was properly closed.
[0m18:19:40.977965 [info ] [MainThread]: 
[0m18:19:40.979112 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:19:40.980390 [debug] [MainThread]: Command end result
[0m18:19:41.020052 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:19:41.027709 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:19:41.038592 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m18:19:41.039516 [info ] [MainThread]: 
[0m18:19:41.040715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:41.041886 [info ] [MainThread]: 
[0m18:19:41.042819 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:19:41.044698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3842468, "process_in_blocks": "0", "process_kernel_time": 0.134534, "process_mem_max_rss": "122012", "process_out_blocks": "0", "process_user_time": 1.847869}
[0m18:19:41.046739 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:41.046648 after 1.39 seconds
[0m18:19:41.047963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f8bc2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f8832590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c98f7b4e620>]}
[0m18:19:41.049065 [debug] [MainThread]: Flushing usage events
[0m18:19:41.858792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:05.415579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d755aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d6577e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d6577ee0>]}


============================== 18:24:05.422268 | a65d569d-8885-44d1-8b38-8bccf8925a0f ==============================
[0m18:24:05.422268 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:24:05.424143 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/app/dbt', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select +fct_incidents', 'log_path': '/usr/app/dbt/logs', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m18:24:05.616540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d552e140>]}
[0m18:24:05.663167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d6d8d330>]}
[0m18:24:05.666238 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:24:05.732751 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:24:06.044840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:06.046571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:06.091852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d55d2cb0>]}
[0m18:24:06.212998 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:24:06.226478 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:24:06.321055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d4119750>]}
[0m18:24:06.322697 [info ] [MainThread]: Found 2 models, 1 seed, 7 data tests, 1 source, 434 macros
[0m18:24:06.328549 [info ] [MainThread]: 
[0m18:24:06.330904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:24:06.332800 [info ] [MainThread]: 
[0m18:24:06.336409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:06.346983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:24:06.348313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:24:06.349252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:24:06.390685 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:24:06.391127 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:24:06.391393 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:24:06.392317 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:24:06.393433 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:24:06.394671 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:24:06.395730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:06.396728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:06.397704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:06.425111 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m18:24:06.425528 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m18:24:06.425825 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m18:24:06.427784 [debug] [ThreadPool]: On list_new_york: Close
[0m18:24:06.430072 [debug] [ThreadPool]: On list_new_york: Close
[0m18:24:06.432730 [debug] [ThreadPool]: On list_new_york: Close
[0m18:24:06.438522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public)
[0m18:24:06.438951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public_analytics)
[0m18:24:06.439396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public_staging)
[0m18:24:06.444509 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:24:06.447205 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:24:06.450229 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:24:06.451711 [debug] [ThreadPool]: On list_new_york_public: BEGIN
[0m18:24:06.452532 [debug] [ThreadPool]: On list_new_york_public_analytics: BEGIN
[0m18:24:06.453749 [debug] [ThreadPool]: On list_new_york_public_staging: BEGIN
[0m18:24:06.455159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:06.456414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:06.458031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:06.465222 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:24:06.466262 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:24:06.466743 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:24:06.467845 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:24:06.468098 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_analytics"
[0m18:24:06.469618 [debug] [ThreadPool]: On list_new_york_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:24:06.470972 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:24:06.472683 [debug] [ThreadPool]: On list_new_york_public_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_analytics"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_analytics'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_analytics'
  
[0m18:24:06.475793 [debug] [ThreadPool]: On list_new_york_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_staging"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:24:06.477932 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:24:06.481368 [debug] [ThreadPool]: On list_new_york_public: ROLLBACK
[0m18:24:06.481651 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m18:24:06.482618 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m18:24:06.483245 [debug] [ThreadPool]: On list_new_york_public: Close
[0m18:24:06.485163 [debug] [ThreadPool]: On list_new_york_public_analytics: ROLLBACK
[0m18:24:06.487373 [debug] [ThreadPool]: On list_new_york_public_staging: ROLLBACK
[0m18:24:06.491582 [debug] [ThreadPool]: On list_new_york_public_analytics: Close
[0m18:24:06.493368 [debug] [ThreadPool]: On list_new_york_public_staging: Close
[0m18:24:06.498778 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:06.500351 [debug] [MainThread]: On master: BEGIN
[0m18:24:06.501699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:06.508298 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:24:06.509580 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:06.511168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:24:06.520225 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m18:24:06.522504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d411b3d0>]}
[0m18:24:06.523977 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:06.525648 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:06.527199 [debug] [MainThread]: On master: BEGIN
[0m18:24:06.529013 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:24:06.530440 [debug] [MainThread]: On master: COMMIT
[0m18:24:06.531742 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:06.533373 [debug] [MainThread]: On master: COMMIT
[0m18:24:06.534989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:06.536558 [debug] [MainThread]: On master: Close
[0m18:24:06.542654 [debug] [Thread-1 (]: Began running node seed.nyc_911_analytics.borough_centroids
[0m18:24:06.542973 [debug] [Thread-2 (]: Began running node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:24:06.543259 [debug] [Thread-3 (]: Began running node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:24:06.544693 [info ] [Thread-1 (]: 1 of 10 START seed file public.borough_centroids ............................... [RUN]
[0m18:24:06.546141 [info ] [Thread-2 (]: 2 of 10 START test source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id .... [RUN]
[0m18:24:06.547197 [info ] [Thread-3 (]: 3 of 10 START test source_unique_raw_nyc_data_emergency_calls_cad_evnt_id ...... [RUN]
[0m18:24:06.548369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_new_york_public_staging, now seed.nyc_911_analytics.borough_centroids)
[0m18:24:06.549935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_new_york_public_analytics, now test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb)
[0m18:24:06.551543 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_new_york_public, now test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b)
[0m18:24:06.552789 [debug] [Thread-1 (]: Began compiling node seed.nyc_911_analytics.borough_centroids
[0m18:24:06.554500 [debug] [Thread-2 (]: Began compiling node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:24:06.555776 [debug] [Thread-3 (]: Began compiling node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:24:06.557147 [debug] [Thread-1 (]: Began executing node seed.nyc_911_analytics.borough_centroids
[0m18:24:06.569339 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:24:06.579024 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:24:06.650678 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:24:06.652166 [debug] [Thread-2 (]: Began executing node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:24:06.660830 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: BEGIN
[0m18:24:06.676398 [debug] [Thread-3 (]: Began executing node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:24:06.699662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:06.710619 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:24:06.718138 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:24:06.734085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m18:24:06.741585 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:24:06.746063 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "seed.nyc_911_analytics.borough_centroids"} */
truncate table "new_york"."public"."borough_centroids"
[0m18:24:06.756177 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m18:24:06.790904 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:24:06.795400 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:24:06.798592 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: 
          insert into "new_york"."public"."borough_centroids" ("borough_name", "centroid_lat", "centroid_lon") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:24:06.806177 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: BEGIN
[0m18:24:06.809694 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:24:06.818126 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m18:24:06.826709 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:24:06.831511 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: BEGIN
[0m18:24:06.843563 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.nyc_911_analytics.borough_centroids"
[0m18:24:06.850197 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:24:06.853773 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m18:24:06.856394 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:24:06.858395 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cad_evnt_id as unique_field,
    count(*) as n_records

from "new_york"."public"."emergency_calls"
where cad_evnt_id is not null
group by cad_evnt_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:24:06.860243 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m18:24:06.861814 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:24:06.862124 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:06.863744 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cad_evnt_id
from "new_york"."public"."emergency_calls"
where cad_evnt_id is null



  
  
      
    ) dbt_internal_test
[0m18:24:06.868453 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: ROLLBACK
[0m18:24:06.871938 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:24:06.887924 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: Close
[0m18:24:06.889639 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: COMMIT
[0m18:24:06.893409 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: ROLLBACK
[0m18:24:06.896470 [info ] [Thread-3 (]: 3 of 10 PASS source_unique_raw_nyc_data_emergency_calls_cad_evnt_id ............ [[32mPASS[0m in 0.34s]
[0m18:24:06.898593 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:24:06.899965 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: Close
[0m18:24:06.901333 [debug] [Thread-3 (]: Finished running node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:24:06.902975 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: COMMIT
[0m18:24:06.904978 [info ] [Thread-2 (]: 2 of 10 PASS source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id .......... [[32mPASS[0m in 0.36s]
[0m18:24:06.908519 [debug] [Thread-2 (]: Finished running node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:24:06.910501 [debug] [Thread-4 (]: Began running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:24:06.911579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:24:06.912053 [info ] [Thread-4 (]: 4 of 10 START sql view model public_staging.stg_nyc_911_calls .................. [RUN]
[0m18:24:06.914113 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: Close
[0m18:24:06.915351 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nyc_911_analytics.stg_nyc_911_calls'
[0m18:24:06.918472 [debug] [Thread-4 (]: Began compiling node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:24:06.918874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d2176860>]}
[0m18:24:06.922243 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:06.924029 [info ] [Thread-1 (]: 1 of 10 OK loaded seed file public.borough_centroids ........................... [[32mINSERT 5[0m in 0.37s]
[0m18:24:06.926799 [debug] [Thread-1 (]: Finished running node seed.nyc_911_analytics.borough_centroids
[0m18:24:06.937503 [debug] [Thread-4 (]: Began executing node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:24:06.964324 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:06.978285 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:06.979956 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: BEGIN
[0m18:24:06.981149 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:24:06.987659 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m18:24:06.989480 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:06.991092 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */

  create view "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp"
    
    
  as (
    with source as (

    select * from "new_york"."public"."emergency_calls"

),

renamed as (

    select
        -- IDs y Claves
        cad_evnt_id as event_id,
        
        -- Fechas y Tiempos
        create_date as created_at,
        incident_date,
        incident_time, -- Podrías intentar combinarlos si incident_date no tiene hora
        add_ts as added_at,
        disp_ts as dispatched_at,
        arrivd_ts as arrived_at,
        closng_ts as closed_at,

        -- Detalles del Incidente
        typ_desc as incident_type_description,
        radio_code,
        cip_jobs as job_status, -- Critical Injury / Police jobs
        
        -- Ubicación
        boro_nm as borough,
        patrl_boro_nm as patrol_borough,
        nypd_pct_cd as precinct_id,
        latitude,
        longitude,
        geo_cd_x,
        geo_cd_y

    from source

)

select * from renamed
  );
[0m18:24:06.997957 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:24:07.005910 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:07.007947 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls" rename to "stg_nyc_911_calls__dbt_backup"
[0m18:24:07.010272 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:24:07.013805 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:07.015570 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp" rename to "stg_nyc_911_calls"
[0m18:24:07.017787 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:24:07.021987 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:24:07.023608 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:07.025025 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:24:07.029168 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:24:07.035573 [debug] [Thread-4 (]: Applying DROP to: "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup"
[0m18:24:07.039991 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:24:07.041576 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
drop view if exists "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup" cascade
[0m18:24:07.047201 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:24:07.049641 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: Close
[0m18:24:07.051628 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21b3f3d480>]}
[0m18:24:07.053884 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public_staging.stg_nyc_911_calls ............. [[32mCREATE VIEW[0m in 0.14s]
[0m18:24:07.055362 [debug] [Thread-4 (]: Finished running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:24:07.057239 [debug] [Thread-2 (]: Began running node model.nyc_911_analytics.fct_incidents
[0m18:24:07.058752 [info ] [Thread-2 (]: 5 of 10 START sql table model public_analytics.fct_incidents ................... [RUN]
[0m18:24:07.060301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb, now model.nyc_911_analytics.fct_incidents)
[0m18:24:07.061644 [debug] [Thread-2 (]: Began compiling node model.nyc_911_analytics.fct_incidents
[0m18:24:07.065496 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.081095 [debug] [Thread-2 (]: Began executing node model.nyc_911_analytics.fct_incidents
[0m18:24:07.097635 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.117182 [debug] [Thread-2 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.118559 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: BEGIN
[0m18:24:07.119647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:24:07.127255 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m18:24:07.128992 [debug] [Thread-2 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.129879 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */

  
    

  create  table "new_york"."public_analytics"."fct_incidents__dbt_tmp"
  
  
    as
  
  (
    with staging as (
    
    select * from "new_york"."public_staging"."stg_nyc_911_calls"
),

centroids as (

    select * from "new_york"."public"."borough_centroids"

),

-- 1. Separamos los datos que YA tienen barrio
data_with_borough as (
    
    select * from staging 
    where borough is not null

),

-- 2. Separamos los datos que NO tienen barrio (NULL)
data_missing_borough as (
    
    select * from staging 
    where borough is null 
      and latitude is not null -- Solo podemos arreglar si tenemos coordenadas

),

-- 3. Magia: Cruzamos los nulos con los 5 centroides y calculamos la distancia
calculated_boroughs as (
    
    select 
        incident.event_id,
        centroid.borough_name as imputed_borough,
        -- Fórmula de distancia simple (Pitagoras) para encontrar el más cercano
        (power(incident.latitude - centroid.centroid_lat, 2) + 
         power(incident.longitude - centroid.centroid_lon, 2)) as distance_squared
    from data_missing_borough incident
    cross join centroids centroid

),

-- 4. Nos quedamos solo con el barrio más cercano para cada incidente
closest_match as (
    
    select distinct on (event_id)
        event_id,
        imputed_borough
    from calculated_boroughs
    order by event_id, distance_squared asc

),

-- 5. Unimos todo de nuevo
final_combined as (

    -- Filas originales que estaban bien
    select 
        event_id,
        incident_type_description,
        borough,
        dispatched_at, -- Necesarios para cálculo, luego los quitamos
        arrived_at,
        created_at,
        closed_at,
        latitude,
        longitude
    from data_with_borough

    union all

    -- Filas reparadas (unimos la data original con el barrio calculado)
    select 
        m.event_id,
        m.incident_type_description,
        c.imputed_borough as borough, -- Aquí usamos el barrio calculado
        m.dispatched_at,
        m.arrived_at,
        m.created_at,
        m.closed_at,
        m.latitude,
        m.longitude
    from data_missing_borough m
    join closest_match c on m.event_id = c.event_id

),

metrics as (

    select
        event_id,
        incident_type_description,
        borough,
        
        -- Cálculos (usamos las fechas aquí antes de descartarlas)
        extract(epoch from (arrived_at - dispatched_at)) / 60 as response_time_minutes,
        extract(epoch from (closed_at - created_at)) / 60 as total_duration_minutes,

        latitude,
        longitude

    from final_combined
    -- Filtros de limpieza
    where dispatched_at is not null 
      and arrived_at is not null

)

-- Selección final: Aquí EXCLUIMOS precinct_id, created_at y arrived_at como pediste
select 
    event_id,
    incident_type_description,
    borough,
    response_time_minutes,
    total_duration_minutes,
    latitude,
    longitude
from metrics
  );
  
[0m18:24:07.139211 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.008 seconds
[0m18:24:07.146339 [debug] [Thread-2 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.148030 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
alter table "new_york"."public_analytics"."fct_incidents" rename to "fct_incidents__dbt_backup"
[0m18:24:07.149802 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:24:07.152928 [debug] [Thread-2 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.154239 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
alter table "new_york"."public_analytics"."fct_incidents__dbt_tmp" rename to "fct_incidents"
[0m18:24:07.155919 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:24:07.157483 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: COMMIT
[0m18:24:07.158819 [debug] [Thread-2 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.160012 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: COMMIT
[0m18:24:07.166184 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m18:24:07.169065 [debug] [Thread-2 (]: Applying DROP to: "new_york"."public_analytics"."fct_incidents__dbt_backup"
[0m18:24:07.172160 [debug] [Thread-2 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:24:07.173416 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
drop table if exists "new_york"."public_analytics"."fct_incidents__dbt_backup" cascade
[0m18:24:07.178772 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:24:07.182166 [debug] [Thread-2 (]: On model.nyc_911_analytics.fct_incidents: Close
[0m18:24:07.184814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a65d569d-8885-44d1-8b38-8bccf8925a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d21b90f0>]}
[0m18:24:07.186020 [info ] [Thread-2 (]: 5 of 10 OK created sql table model public_analytics.fct_incidents .............. [[32mSELECT 0[0m in 0.12s]
[0m18:24:07.187518 [debug] [Thread-2 (]: Finished running node model.nyc_911_analytics.fct_incidents
[0m18:24:07.189693 [debug] [Thread-1 (]: Began running node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:24:07.190153 [debug] [Thread-4 (]: Began running node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:24:07.190605 [debug] [Thread-3 (]: Began running node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:24:07.191090 [debug] [Thread-2 (]: Began running node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:24:07.191928 [info ] [Thread-1 (]: 6 of 10 START test accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND  [RUN]
[0m18:24:07.193547 [info ] [Thread-4 (]: 7 of 10 START test not_null_fct_incidents_borough .............................. [RUN]
[0m18:24:07.195382 [info ] [Thread-3 (]: 8 of 10 START test not_null_fct_incidents_event_id ............................. [RUN]
[0m18:24:07.196721 [info ] [Thread-2 (]: 9 of 10 START test not_null_fct_incidents_response_time_minutes ................ [RUN]
[0m18:24:07.198482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.nyc_911_analytics.borough_centroids, now test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346)
[0m18:24:07.200143 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_911_analytics.stg_nyc_911_calls, now test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450)
[0m18:24:07.201800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b, now test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e)
[0m18:24:07.203341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nyc_911_analytics.fct_incidents, now test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6)
[0m18:24:07.204737 [debug] [Thread-1 (]: Began compiling node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:24:07.206337 [debug] [Thread-4 (]: Began compiling node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:24:07.207786 [debug] [Thread-3 (]: Began compiling node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:24:07.208885 [debug] [Thread-2 (]: Began compiling node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:24:07.218492 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:24:07.222405 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:24:07.227992 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:24:07.233242 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:24:07.244845 [debug] [Thread-2 (]: Began executing node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:24:07.247436 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:24:07.250195 [debug] [Thread-1 (]: Began executing node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:24:07.252932 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:24:07.254492 [debug] [Thread-3 (]: Began executing node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:24:07.257848 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:24:07.258323 [debug] [Thread-4 (]: Began executing node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:24:07.262437 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:24:07.268330 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:24:07.269638 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: BEGIN
[0m18:24:07.271287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:24:07.272380 [debug] [Thread-1 (]: Using postgres connection "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:24:07.275052 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: BEGIN
[0m18:24:07.275562 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:24:07.278168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:07.281687 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: BEGIN
[0m18:24:07.282248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m18:24:07.282756 [debug] [Thread-4 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:24:07.285737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:24:07.287513 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:24:07.289270 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: BEGIN
[0m18:24:07.291838 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select response_time_minutes
from "new_york"."public_analytics"."fct_incidents"
where response_time_minutes is null



  
  
      
    ) dbt_internal_test
[0m18:24:07.292218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m18:24:07.293962 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:24:07.297607 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:07.298824 [debug] [Thread-1 (]: Using postgres connection "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:24:07.300278 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m18:24:07.302445 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: ROLLBACK
[0m18:24:07.303583 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        borough as value_field,
        count(*) as n_records

    from "new_york"."public_analytics"."fct_incidents"
    group by borough

)

select *
from all_values
where value_field not in (
    'MANHATTAN','BRONX','BROOKLYN','QUEENS','STATEN ISLAND'
)



  
  
      
    ) dbt_internal_test
[0m18:24:07.304604 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:24:07.305895 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: Close
[0m18:24:07.306472 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m18:24:07.307488 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "new_york"."public_analytics"."fct_incidents"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:24:07.308414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:07.308885 [info ] [Thread-2 (]: 9 of 10 PASS not_null_fct_incidents_response_time_minutes ...................... [[32mPASS[0m in 0.11s]
[0m18:24:07.310410 [debug] [Thread-4 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:24:07.312400 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: ROLLBACK
[0m18:24:07.312790 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:07.314147 [debug] [Thread-2 (]: Finished running node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:24:07.316196 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "new_york"."public_analytics"."fct_incidents"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:24:07.317853 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: Close
[0m18:24:07.319316 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: ROLLBACK
[0m18:24:07.320063 [debug] [Thread-2 (]: Began running node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:24:07.321734 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:24:07.322220 [info ] [Thread-1 (]: 6 of 10 PASS accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND  [[32mPASS[0m in 0.12s]
[0m18:24:07.323139 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: Close
[0m18:24:07.324356 [info ] [Thread-2 (]: 10 of 10 START test unique_fct_incidents_event_id .............................. [RUN]
[0m18:24:07.326820 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: ROLLBACK
[0m18:24:07.328127 [debug] [Thread-1 (]: Finished running node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:24:07.329806 [info ] [Thread-3 (]: 8 of 10 PASS not_null_fct_incidents_event_id ................................... [[32mPASS[0m in 0.13s]
[0m18:24:07.330615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6, now test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af)
[0m18:24:07.331828 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: Close
[0m18:24:07.333828 [debug] [Thread-3 (]: Finished running node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:24:07.335044 [debug] [Thread-2 (]: Began compiling node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:24:07.336210 [info ] [Thread-4 (]: 7 of 10 PASS not_null_fct_incidents_borough .................................... [[32mPASS[0m in 0.14s]
[0m18:24:07.340515 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:24:07.341703 [debug] [Thread-4 (]: Finished running node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:24:07.352045 [debug] [Thread-2 (]: Began executing node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:24:07.354729 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:24:07.362507 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:24:07.363839 [debug] [Thread-2 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: BEGIN
[0m18:24:07.364933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:24:07.371691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:24:07.372826 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:24:07.373671 [debug] [Thread-2 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "new_york"."public_analytics"."fct_incidents"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:24:07.377339 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:24:07.379435 [debug] [Thread-2 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: ROLLBACK
[0m18:24:07.380951 [debug] [Thread-2 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: Close
[0m18:24:07.382426 [info ] [Thread-2 (]: 10 of 10 PASS unique_fct_incidents_event_id .................................... [[32mPASS[0m in 0.05s]
[0m18:24:07.383629 [debug] [Thread-2 (]: Finished running node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:24:07.385978 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:07.386967 [debug] [MainThread]: On master: BEGIN
[0m18:24:07.388101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:07.399922 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:24:07.401942 [debug] [MainThread]: On master: COMMIT
[0m18:24:07.404501 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:07.406414 [debug] [MainThread]: On master: COMMIT
[0m18:24:07.408353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:07.410995 [debug] [MainThread]: On master: Close
[0m18:24:07.413279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:07.414999 [debug] [MainThread]: Connection 'test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346' was properly closed.
[0m18:24:07.416890 [debug] [MainThread]: Connection 'test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e' was properly closed.
[0m18:24:07.418259 [debug] [MainThread]: Connection 'test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af' was properly closed.
[0m18:24:07.419390 [debug] [MainThread]: Connection 'test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450' was properly closed.
[0m18:24:07.420951 [info ] [MainThread]: 
[0m18:24:07.423197 [info ] [MainThread]: Finished running 1 seed, 1 table model, 7 data tests, 1 view model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m18:24:07.427168 [debug] [MainThread]: Command end result
[0m18:24:07.467012 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:24:07.474738 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:24:07.487264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m18:24:07.489003 [info ] [MainThread]: 
[0m18:24:07.490696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:07.492256 [info ] [MainThread]: 
[0m18:24:07.493748 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m18:24:07.499022 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.1600366, "process_in_blocks": "86864", "process_kernel_time": 0.258812, "process_mem_max_rss": "124296", "process_out_blocks": "0", "process_user_time": 2.260562}
[0m18:24:07.500589 [debug] [MainThread]: Command `dbt build` succeeded at 18:24:07.500450 after 2.16 seconds
[0m18:24:07.502256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d755aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d51388b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21d45610c0>]}
[0m18:24:07.503958 [debug] [MainThread]: Flushing usage events
[0m18:24:08.073344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:25:38.388120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b06a6dea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b069722b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b069722b90>]}


============================== 18:25:38.394869 | 5f3ed03f-0d1a-42a5-bd81-91192a86e199 ==============================
[0m18:25:38.394869 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:25:38.397216 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt build --select +fct_incidents', 'empty': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False'}
[0m18:25:38.583840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b0695e4040>]}
[0m18:25:38.631050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b069939cc0>]}
[0m18:25:38.636863 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:25:38.703640 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:25:38.814108 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:25:38.815878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b069f5e7d0>]}
[0m18:25:39.830843 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:25:39.832572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b064475780>]}
[0m18:25:40.038572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b064598370>]}
[0m18:25:40.139373 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:25:40.146724 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:25:40.196504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b0681ac5b0>]}
[0m18:25:40.197276 [info ] [MainThread]: Found 2 models, 1 seed, 7 data tests, 1 source, 434 macros
[0m18:25:40.202365 [info ] [MainThread]: 
[0m18:25:40.203704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:25:40.204853 [info ] [MainThread]: 
[0m18:25:40.206264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:40.211934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:25:40.212610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:25:40.213451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_new_york'
[0m18:25:40.252357 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:25:40.252733 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:25:40.253081 [debug] [ThreadPool]: Using postgres connection "list_new_york"
[0m18:25:40.254037 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:25:40.255927 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:25:40.257567 [debug] [ThreadPool]: On list_new_york: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york"} */

    select distinct nspname from pg_namespace
  
[0m18:25:40.258976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:40.260485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:40.261589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:40.286574 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m18:25:40.286920 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.028 seconds
[0m18:25:40.287150 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.027 seconds
[0m18:25:40.288557 [debug] [ThreadPool]: On list_new_york: Close
[0m18:25:40.290130 [debug] [ThreadPool]: On list_new_york: Close
[0m18:25:40.291590 [debug] [ThreadPool]: On list_new_york: Close
[0m18:25:40.295687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now create_new_york_public_public)
[0m18:25:40.296967 [debug] [ThreadPool]: Creating schema "database: "new_york"
schema: "public_public"
"
[0m18:25:40.301696 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_public"
[0m18:25:40.302763 [debug] [ThreadPool]: On create_new_york_public_public: BEGIN
[0m18:25:40.303647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:40.309227 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:25:40.310324 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_public"
[0m18:25:40.311300 [debug] [ThreadPool]: On create_new_york_public_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "create_new_york_public_public"} */
create schema if not exists "public_public"
[0m18:25:40.313078 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:25:40.314415 [debug] [ThreadPool]: On create_new_york_public_public: COMMIT
[0m18:25:40.315130 [debug] [ThreadPool]: Using postgres connection "create_new_york_public_public"
[0m18:25:40.315916 [debug] [ThreadPool]: On create_new_york_public_public: COMMIT
[0m18:25:40.318525 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:25:40.319185 [debug] [ThreadPool]: On create_new_york_public_public: Close
[0m18:25:40.320629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_new_york_public_public, now list_new_york_public)
[0m18:25:40.321033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public_public)
[0m18:25:40.321419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_new_york, now list_new_york_public_staging)
[0m18:25:40.325855 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:25:40.327725 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_public"
[0m18:25:40.329743 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:25:40.330398 [debug] [ThreadPool]: On list_new_york_public: BEGIN
[0m18:25:40.330978 [debug] [ThreadPool]: On list_new_york_public_public: BEGIN
[0m18:25:40.331518 [debug] [ThreadPool]: On list_new_york_public_staging: BEGIN
[0m18:25:40.332245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:40.332762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:40.333215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:40.339208 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:40.339807 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:40.340406 [debug] [ThreadPool]: Using postgres connection "list_new_york_public"
[0m18:25:40.340643 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:25:40.341487 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_public"
[0m18:25:40.342142 [debug] [ThreadPool]: On list_new_york_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:25:40.342878 [debug] [ThreadPool]: Using postgres connection "list_new_york_public_staging"
[0m18:25:40.343450 [debug] [ThreadPool]: On list_new_york_public_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_public"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m18:25:40.344735 [debug] [ThreadPool]: On list_new_york_public_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "list_new_york_public_staging"} */
select
      'new_york' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'new_york' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m18:25:40.348156 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m18:25:40.349725 [debug] [ThreadPool]: On list_new_york_public: ROLLBACK
[0m18:25:40.349968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m18:25:40.350220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:25:40.350893 [debug] [ThreadPool]: On list_new_york_public: Close
[0m18:25:40.351949 [debug] [ThreadPool]: On list_new_york_public_public: ROLLBACK
[0m18:25:40.353065 [debug] [ThreadPool]: On list_new_york_public_staging: ROLLBACK
[0m18:25:40.354740 [debug] [ThreadPool]: On list_new_york_public_public: Close
[0m18:25:40.355374 [debug] [ThreadPool]: On list_new_york_public_staging: Close
[0m18:25:40.360235 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.360932 [debug] [MainThread]: On master: BEGIN
[0m18:25:40.361690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:40.366921 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:25:40.367552 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.368254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:25:40.373577 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m18:25:40.375158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b067975480>]}
[0m18:25:40.376089 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:40.376818 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.377527 [debug] [MainThread]: On master: BEGIN
[0m18:25:40.378565 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:25:40.379252 [debug] [MainThread]: On master: COMMIT
[0m18:25:40.379889 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.380559 [debug] [MainThread]: On master: COMMIT
[0m18:25:40.381475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:25:40.382159 [debug] [MainThread]: On master: Close
[0m18:25:40.387393 [debug] [Thread-1 (]: Began running node seed.nyc_911_analytics.borough_centroids
[0m18:25:40.387721 [debug] [Thread-2 (]: Began running node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:25:40.388048 [debug] [Thread-3 (]: Began running node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:25:40.388749 [info ] [Thread-1 (]: 1 of 10 START seed file public.borough_centroids ............................... [RUN]
[0m18:25:40.389491 [info ] [Thread-2 (]: 2 of 10 START test source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id .... [RUN]
[0m18:25:40.390505 [info ] [Thread-3 (]: 3 of 10 START test source_unique_raw_nyc_data_emergency_calls_cad_evnt_id ...... [RUN]
[0m18:25:40.391437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_new_york_public_staging, now seed.nyc_911_analytics.borough_centroids)
[0m18:25:40.392297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_new_york_public_public, now test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb)
[0m18:25:40.393110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_new_york_public, now test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b)
[0m18:25:40.393952 [debug] [Thread-1 (]: Began compiling node seed.nyc_911_analytics.borough_centroids
[0m18:25:40.394747 [debug] [Thread-2 (]: Began compiling node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:25:40.395402 [debug] [Thread-3 (]: Began compiling node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:25:40.396127 [debug] [Thread-1 (]: Began executing node seed.nyc_911_analytics.borough_centroids
[0m18:25:40.407145 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:25:40.412559 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:25:40.439614 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:25:40.440011 [debug] [Thread-2 (]: Began executing node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:25:40.441399 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: BEGIN
[0m18:25:40.442052 [debug] [Thread-3 (]: Began executing node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:25:40.454147 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:25:40.454729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:40.457148 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:25:40.462978 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:25:40.465038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:25:40.465341 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: BEGIN
[0m18:25:40.465875 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:25:40.466305 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:25:40.466961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:40.468414 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: BEGIN
[0m18:25:40.469280 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "seed.nyc_911_analytics.borough_centroids"} */
truncate table "new_york"."public"."borough_centroids"
[0m18:25:40.470921 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:25:40.474728 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m18:25:40.475974 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"
[0m18:25:40.476238 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m18:25:40.476837 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cad_evnt_id
from "new_york"."public"."emergency_calls"
where cad_evnt_id is null



  
  
      
    ) dbt_internal_test
[0m18:25:40.477117 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m18:25:40.490339 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:25:40.491789 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"
[0m18:25:40.492180 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:25:40.492741 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: 
          insert into "new_york"."public"."borough_centroids" ("borough_name", "centroid_lat", "centroid_lon") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m18:25:40.493407 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    cad_evnt_id as unique_field,
    count(*) as n_records

from "new_york"."public"."emergency_calls"
where cad_evnt_id is not null
group by cad_evnt_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:25:40.496925 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: ROLLBACK
[0m18:25:40.498393 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.000 seconds
[0m18:25:40.499687 [debug] [Thread-2 (]: On test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb: Close
[0m18:25:40.503725 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.nyc_911_analytics.borough_centroids"
[0m18:25:40.504087 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:25:40.504913 [info ] [Thread-2 (]: 2 of 10 PASS source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id .......... [[32mPASS[0m in 0.11s]
[0m18:25:40.506973 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: ROLLBACK
[0m18:25:40.507826 [debug] [Thread-2 (]: Finished running node test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb
[0m18:25:40.508629 [debug] [Thread-3 (]: On test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b: Close
[0m18:25:40.510649 [info ] [Thread-3 (]: 3 of 10 PASS source_unique_raw_nyc_data_emergency_calls_cad_evnt_id ............ [[32mPASS[0m in 0.12s]
[0m18:25:40.511809 [debug] [Thread-3 (]: Finished running node test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b
[0m18:25:40.519094 [debug] [Thread-4 (]: Began running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:25:40.524624 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: COMMIT
[0m18:25:40.525623 [info ] [Thread-4 (]: 4 of 10 START sql view model public_staging.stg_nyc_911_calls .................. [RUN]
[0m18:25:40.527238 [debug] [Thread-1 (]: Using postgres connection "seed.nyc_911_analytics.borough_centroids"
[0m18:25:40.528312 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nyc_911_analytics.stg_nyc_911_calls'
[0m18:25:40.529137 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: COMMIT
[0m18:25:40.529960 [debug] [Thread-4 (]: Began compiling node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:25:40.533461 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.533762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:25:40.535319 [debug] [Thread-1 (]: On seed.nyc_911_analytics.borough_centroids: Close
[0m18:25:40.537616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b016653a00>]}
[0m18:25:40.538438 [info ] [Thread-1 (]: 1 of 10 OK loaded seed file public.borough_centroids ........................... [[32mINSERT 5[0m in 0.14s]
[0m18:25:40.539354 [debug] [Thread-1 (]: Finished running node seed.nyc_911_analytics.borough_centroids
[0m18:25:40.543179 [debug] [Thread-4 (]: Began executing node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:25:40.565981 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.572965 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.574050 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: BEGIN
[0m18:25:40.574797 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:25:40.580988 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m18:25:40.581648 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.582395 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */

  create view "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp"
    
    
  as (
    with source as (

    select * from "new_york"."public"."emergency_calls"

),

renamed as (

    select
        -- IDs y Claves
        cad_evnt_id as event_id,
        
        -- Fechas y Tiempos
        create_date as created_at,
        incident_date,
        incident_time, -- Podrías intentar combinarlos si incident_date no tiene hora
        add_ts as added_at,
        disp_ts as dispatched_at,
        arrivd_ts as arrived_at,
        closng_ts as closed_at,

        -- Detalles del Incidente
        typ_desc as incident_type_description,
        radio_code,
        cip_jobs as job_status, -- Critical Injury / Police jobs
        
        -- Ubicación
        boro_nm as borough,
        patrl_boro_nm as patrol_borough,
        nypd_pct_cd as precinct_id,
        latitude,
        longitude,
        geo_cd_x,
        geo_cd_y

    from source

)

select * from renamed
  );
[0m18:25:40.586713 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:25:40.592194 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.593076 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls" rename to "stg_nyc_911_calls__dbt_backup"
[0m18:25:40.594387 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:25:40.596994 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.597821 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
alter table "new_york"."public_staging"."stg_nyc_911_calls__dbt_tmp" rename to "stg_nyc_911_calls"
[0m18:25:40.599137 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:25:40.601985 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:25:40.602763 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.603494 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: COMMIT
[0m18:25:40.606150 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:25:40.611343 [debug] [Thread-4 (]: Applying DROP to: "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup"
[0m18:25:40.614960 [debug] [Thread-4 (]: Using postgres connection "model.nyc_911_analytics.stg_nyc_911_calls"
[0m18:25:40.615882 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.stg_nyc_911_calls"} */
drop view if exists "new_york"."public_staging"."stg_nyc_911_calls__dbt_backup" cascade
[0m18:25:40.621866 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m18:25:40.624754 [debug] [Thread-4 (]: On model.nyc_911_analytics.stg_nyc_911_calls: Close
[0m18:25:40.626949 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b014592500>]}
[0m18:25:40.629225 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public_staging.stg_nyc_911_calls ............. [[32mCREATE VIEW[0m in 0.10s]
[0m18:25:40.630205 [debug] [Thread-4 (]: Finished running node model.nyc_911_analytics.stg_nyc_911_calls
[0m18:25:40.631363 [debug] [Thread-3 (]: Began running node model.nyc_911_analytics.fct_incidents
[0m18:25:40.632434 [info ] [Thread-3 (]: 5 of 10 START sql table model public_public.fct_incidents ...................... [RUN]
[0m18:25:40.633452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nyc_911_analytics.source_unique_raw_nyc_data_emergency_calls_cad_evnt_id.d65757aa3b, now model.nyc_911_analytics.fct_incidents)
[0m18:25:40.634440 [debug] [Thread-3 (]: Began compiling node model.nyc_911_analytics.fct_incidents
[0m18:25:40.637493 [debug] [Thread-3 (]: Writing injected SQL for node "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.643800 [debug] [Thread-3 (]: Began executing node model.nyc_911_analytics.fct_incidents
[0m18:25:40.660750 [debug] [Thread-3 (]: Writing runtime sql for node "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.667881 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.668697 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: BEGIN
[0m18:25:40.669431 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:25:40.675437 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m18:25:40.676303 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.677017 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */

  
    

  create  table "new_york"."public_public"."fct_incidents__dbt_tmp"
  
  
    as
  
  (
    with staging as (
    
    select * from "new_york"."public_staging"."stg_nyc_911_calls"
),

centroids as (

    select * from "new_york"."public"."borough_centroids"

),

-- 1. Separamos los datos que YA tienen barrio
data_with_borough as (
    
    select * from staging 
    where borough is not null

),

-- 2. Separamos los datos que NO tienen barrio (NULL)
data_missing_borough as (
    
    select * from staging 
    where borough is null 
      and latitude is not null -- Solo podemos arreglar si tenemos coordenadas

),

-- 3. Magia: Cruzamos los nulos con los 5 centroides y calculamos la distancia
calculated_boroughs as (
    
    select 
        incident.event_id,
        centroid.borough_name as imputed_borough,
        -- Fórmula de distancia simple (Pitagoras) para encontrar el más cercano
        (power(incident.latitude - centroid.centroid_lat, 2) + 
         power(incident.longitude - centroid.centroid_lon, 2)) as distance_squared
    from data_missing_borough incident
    cross join centroids centroid

),

-- 4. Nos quedamos solo con el barrio más cercano para cada incidente
closest_match as (
    
    select distinct on (event_id)
        event_id,
        imputed_borough
    from calculated_boroughs
    order by event_id, distance_squared asc

),

-- 5. Unimos todo de nuevo
final_combined as (

    -- Filas originales que estaban bien
    select 
        event_id,
        incident_type_description,
        borough,
        dispatched_at, -- Necesarios para cálculo, luego los quitamos
        arrived_at,
        created_at,
        closed_at,
        latitude,
        longitude
    from data_with_borough

    union all

    -- Filas reparadas (unimos la data original con el barrio calculado)
    select 
        m.event_id,
        m.incident_type_description,
        c.imputed_borough as borough, -- Aquí usamos el barrio calculado
        m.dispatched_at,
        m.arrived_at,
        m.created_at,
        m.closed_at,
        m.latitude,
        m.longitude
    from data_missing_borough m
    join closest_match c on m.event_id = c.event_id

),

metrics as (

    select
        event_id,
        incident_type_description,
        borough,
        
        -- Cálculos (usamos las fechas aquí antes de descartarlas)
        extract(epoch from (arrived_at - dispatched_at)) / 60 as response_time_minutes,
        extract(epoch from (closed_at - created_at)) / 60 as total_duration_minutes,

        latitude,
        longitude

    from final_combined
    -- Filtros de limpieza
    where dispatched_at is not null 
      and arrived_at is not null

)

-- Selección final: Aquí EXCLUIMOS precinct_id, created_at y arrived_at como pediste
select 
    event_id,
    incident_type_description,
    borough,
    response_time_minutes,
    total_duration_minutes,
    latitude,
    longitude
from metrics
  );
  
[0m18:25:40.683591 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.006 seconds
[0m18:25:40.689089 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.689972 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
alter table "new_york"."public_public"."fct_incidents__dbt_tmp" rename to "fct_incidents"
[0m18:25:40.690965 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:25:40.692458 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: COMMIT
[0m18:25:40.693215 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.693919 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: COMMIT
[0m18:25:40.696394 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m18:25:40.698599 [debug] [Thread-3 (]: Applying DROP to: "new_york"."public_public"."fct_incidents__dbt_backup"
[0m18:25:40.700923 [debug] [Thread-3 (]: Using postgres connection "model.nyc_911_analytics.fct_incidents"
[0m18:25:40.701738 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "model.nyc_911_analytics.fct_incidents"} */
drop table if exists "new_york"."public_public"."fct_incidents__dbt_backup" cascade
[0m18:25:40.703268 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:25:40.704858 [debug] [Thread-3 (]: On model.nyc_911_analytics.fct_incidents: Close
[0m18:25:40.705755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3ed03f-0d1a-42a5-bd81-91192a86e199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b06450f610>]}
[0m18:25:40.706565 [info ] [Thread-3 (]: 5 of 10 OK created sql table model public_public.fct_incidents ................. [[32mSELECT 0[0m in 0.07s]
[0m18:25:40.708207 [debug] [Thread-3 (]: Finished running node model.nyc_911_analytics.fct_incidents
[0m18:25:40.709647 [debug] [Thread-1 (]: Began running node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:25:40.709938 [debug] [Thread-4 (]: Began running node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:25:40.713521 [info ] [Thread-4 (]: 7 of 10 START test not_null_fct_incidents_borough .............................. [RUN]
[0m18:25:40.710537 [debug] [Thread-3 (]: Began running node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:25:40.711053 [info ] [Thread-1 (]: 6 of 10 START test accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND  [RUN]
[0m18:25:40.710225 [debug] [Thread-2 (]: Began running node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:25:40.714990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nyc_911_analytics.stg_nyc_911_calls, now test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450)
[0m18:25:40.715800 [info ] [Thread-3 (]: 9 of 10 START test not_null_fct_incidents_response_time_minutes ................ [RUN]
[0m18:25:40.716769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.nyc_911_analytics.borough_centroids, now test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346)
[0m18:25:40.718630 [info ] [Thread-2 (]: 8 of 10 START test not_null_fct_incidents_event_id ............................. [RUN]
[0m18:25:40.719411 [debug] [Thread-4 (]: Began compiling node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:25:40.722264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nyc_911_analytics.fct_incidents, now test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6)
[0m18:25:40.724207 [debug] [Thread-1 (]: Began compiling node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:25:40.725007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nyc_911_analytics.source_not_null_raw_nyc_data_emergency_calls_cad_evnt_id.619d825ecb, now test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e)
[0m18:25:40.731623 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:25:40.733608 [debug] [Thread-3 (]: Began compiling node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:25:40.737765 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:25:40.738521 [debug] [Thread-2 (]: Began compiling node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:25:40.742505 [debug] [Thread-3 (]: Writing injected SQL for node "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:25:40.747552 [debug] [Thread-2 (]: Writing injected SQL for node "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:25:40.749407 [debug] [Thread-4 (]: Began executing node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:25:40.749964 [debug] [Thread-1 (]: Began executing node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:25:40.754004 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:25:40.760194 [debug] [Thread-1 (]: Writing runtime sql for node "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:25:40.760639 [debug] [Thread-3 (]: Began executing node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:25:40.765261 [debug] [Thread-2 (]: Began executing node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:25:40.768807 [debug] [Thread-3 (]: Writing runtime sql for node "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:25:40.774829 [debug] [Thread-2 (]: Writing runtime sql for node "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:25:40.776523 [debug] [Thread-4 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:25:40.779325 [debug] [Thread-1 (]: Using postgres connection "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:25:40.782570 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: BEGIN
[0m18:25:40.783960 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: BEGIN
[0m18:25:40.785510 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:25:40.788876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:40.789586 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:25:40.792683 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:25:40.794499 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: BEGIN
[0m18:25:40.797049 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: BEGIN
[0m18:25:40.798353 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m18:25:40.799041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:25:40.799614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:25:40.800756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:25:40.802624 [debug] [Thread-4 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"
[0m18:25:40.805704 [debug] [Thread-1 (]: Using postgres connection "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"
[0m18:25:40.808481 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select borough
from "new_york"."public_public"."fct_incidents"
where borough is null



  
  
      
    ) dbt_internal_test
[0m18:25:40.810129 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        borough as value_field,
        count(*) as n_records

    from "new_york"."public_public"."fct_incidents"
    group by borough

)

select *
from all_values
where value_field not in (
    'MANHATTAN','BRONX','BROOKLYN','QUEENS','STATEN ISLAND'
)



  
  
      
    ) dbt_internal_test
[0m18:25:40.810723 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m18:25:40.812503 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:25:40.813250 [debug] [Thread-3 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"
[0m18:25:40.813519 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:25:40.814013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:25:40.815656 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: ROLLBACK
[0m18:25:40.816740 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select response_time_minutes
from "new_york"."public_public"."fct_incidents"
where response_time_minutes is null



  
  
      
    ) dbt_internal_test
[0m18:25:40.817937 [debug] [Thread-2 (]: Using postgres connection "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"
[0m18:25:40.819637 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: ROLLBACK
[0m18:25:40.820915 [debug] [Thread-4 (]: On test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450: Close
[0m18:25:40.822584 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:25:40.822876 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "new_york"."public_public"."fct_incidents"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:25:40.824352 [debug] [Thread-1 (]: On test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346: Close
[0m18:25:40.825403 [info ] [Thread-4 (]: 7 of 10 PASS not_null_fct_incidents_borough .................................... [[32mPASS[0m in 0.11s]
[0m18:25:40.826767 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: ROLLBACK
[0m18:25:40.828773 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:25:40.829545 [info ] [Thread-1 (]: 6 of 10 PASS accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND  [[32mPASS[0m in 0.11s]
[0m18:25:40.830484 [debug] [Thread-4 (]: Finished running node test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450
[0m18:25:40.831647 [debug] [Thread-3 (]: On test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6: Close
[0m18:25:40.833045 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: ROLLBACK
[0m18:25:40.834138 [debug] [Thread-1 (]: Finished running node test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346
[0m18:25:40.835369 [debug] [Thread-4 (]: Began running node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:25:40.836651 [info ] [Thread-3 (]: 9 of 10 PASS not_null_fct_incidents_response_time_minutes ...................... [[32mPASS[0m in 0.11s]
[0m18:25:40.837896 [debug] [Thread-2 (]: On test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e: Close
[0m18:25:40.839884 [info ] [Thread-4 (]: 10 of 10 START test unique_fct_incidents_event_id .............................. [RUN]
[0m18:25:40.841167 [debug] [Thread-3 (]: Finished running node test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6
[0m18:25:40.842314 [info ] [Thread-2 (]: 8 of 10 PASS not_null_fct_incidents_event_id ................................... [[32mPASS[0m in 0.12s]
[0m18:25:40.843300 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nyc_911_analytics.not_null_fct_incidents_borough.8a60256450, now test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af)
[0m18:25:40.845511 [debug] [Thread-2 (]: Finished running node test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e
[0m18:25:40.846763 [debug] [Thread-4 (]: Began compiling node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:25:40.851587 [debug] [Thread-4 (]: Writing injected SQL for node "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:25:40.866778 [debug] [Thread-4 (]: Began executing node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:25:40.870016 [debug] [Thread-4 (]: Writing runtime sql for node "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:25:40.884485 [debug] [Thread-4 (]: Using postgres connection "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:25:40.886159 [debug] [Thread-4 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: BEGIN
[0m18:25:40.887704 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:25:40.894557 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m18:25:40.895689 [debug] [Thread-4 (]: Using postgres connection "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"
[0m18:25:40.896753 [debug] [Thread-4 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nyc_911_profile", "target_name": "dev", "node_id": "test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "new_york"."public_public"."fct_incidents"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:25:40.899463 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:25:40.901413 [debug] [Thread-4 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: ROLLBACK
[0m18:25:40.902553 [debug] [Thread-4 (]: On test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af: Close
[0m18:25:40.903792 [info ] [Thread-4 (]: 10 of 10 PASS unique_fct_incidents_event_id .................................... [[32mPASS[0m in 0.06s]
[0m18:25:40.905201 [debug] [Thread-4 (]: Finished running node test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af
[0m18:25:40.907159 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.908192 [debug] [MainThread]: On master: BEGIN
[0m18:25:40.909117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:40.915798 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:25:40.917030 [debug] [MainThread]: On master: COMMIT
[0m18:25:40.918134 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.919065 [debug] [MainThread]: On master: COMMIT
[0m18:25:40.920136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:25:40.920922 [debug] [MainThread]: On master: Close
[0m18:25:40.922018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:40.923227 [debug] [MainThread]: Connection 'test.nyc_911_analytics.not_null_fct_incidents_event_id.88b71a051e' was properly closed.
[0m18:25:40.924182 [debug] [MainThread]: Connection 'test.nyc_911_analytics.accepted_values_fct_incidents_borough__MANHATTAN__BRONX__BROOKLYN__QUEENS__STATEN_ISLAND.b59407d346' was properly closed.
[0m18:25:40.925185 [debug] [MainThread]: Connection 'test.nyc_911_analytics.not_null_fct_incidents_response_time_minutes.7c4674f6d6' was properly closed.
[0m18:25:40.926292 [debug] [MainThread]: Connection 'test.nyc_911_analytics.unique_fct_incidents_event_id.fcac0092af' was properly closed.
[0m18:25:40.927420 [info ] [MainThread]: 
[0m18:25:40.928787 [info ] [MainThread]: Finished running 1 seed, 1 table model, 7 data tests, 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m18:25:40.931031 [debug] [MainThread]: Command end result
[0m18:25:41.004328 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m18:25:41.008903 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m18:25:41.039080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m18:25:41.039923 [info ] [MainThread]: 
[0m18:25:41.041999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:41.055072 [info ] [MainThread]: 
[0m18:25:41.056886 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m18:25:41.059369 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:25:41.065419 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.7755363, "process_in_blocks": "87800", "process_kernel_time": 0.208657, "process_mem_max_rss": "133180", "process_out_blocks": "0", "process_user_time": 3.202085}
[0m18:25:41.066932 [debug] [MainThread]: Command `dbt build` succeeded at 18:25:41.066803 after 2.78 seconds
[0m18:25:41.068353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b06a6dea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b06a61d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b06ba57490>]}
[0m18:25:41.069521 [debug] [MainThread]: Flushing usage events
[0m18:25:41.693597 [debug] [MainThread]: An error was encountered while trying to flush usage events
